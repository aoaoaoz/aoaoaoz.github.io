<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">






  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="计算几何," />










<meta name="description" content="题意描述InputOutputSample InputSample Output题意：吉老师的计算几何板子 代码：12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576">
<meta name="keywords" content="计算几何">
<meta property="og:type" content="article">
<meta property="og:title" content="JRY&#39;s_Geo">
<meta property="og:url" content="http://yoursite.com/2019/01/25/JRY-s-Geo/index.html">
<meta property="og:site_name" content="嗷嗷嗷&#39;s Blog">
<meta property="og:description" content="题意描述InputOutputSample InputSample Output题意：吉老师的计算几何板子 代码：12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-01-25T07:55:18.692Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JRY&#39;s_Geo">
<meta name="twitter:description" content="题意描述InputOutputSample InputSample Output题意：吉老师的计算几何板子 代码：12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/01/25/JRY-s-Geo/"/>





  <title>JRY's_Geo | 嗷嗷嗷's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">嗷嗷嗷's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">aoaoao's Blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/25/JRY-s-Geo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">JRY's_Geo</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-25T15:54:30+08:00">
                2019-01-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>吉老师的计算几何板子</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">const</span> db eps=<span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">const</span> db pi=<span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sign</span><span class="params">(db k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k&gt;eps) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">if</span> (k&lt;-eps) <span class="keyword">return</span> <span class="number">-1</span>; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(db k1,db k2)</span></span>&#123;<span class="keyword">return</span> sign(k1-k2);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inmid</span><span class="params">(db k1,db k2,db k3)</span></span>&#123;<span class="keyword">return</span> sign(k1-k3)*sign(k2-k3)&lt;=<span class="number">0</span>;&#125;<span class="comment">// k3 在 [k1,k2] 内 </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span>&#123;</span></span><br><span class="line">    db x,y;</span><br><span class="line">    point <span class="keyword">operator</span> + (<span class="keyword">const</span> point &amp;k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;k1.x+x,k1.y+y&#125;;&#125;</span><br><span class="line">    point <span class="keyword">operator</span> - (<span class="keyword">const</span> point &amp;k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;x-k1.x,y-k1.y&#125;;&#125;</span><br><span class="line">    point <span class="keyword">operator</span> * (db k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;x*k1,y*k1&#125;;&#125;</span><br><span class="line">    point <span class="keyword">operator</span> / (db k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;x/k1,y/k1&#125;;&#125;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> point &amp;k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> cmp(x,k1.x)==<span class="number">0</span>&amp;&amp;cmp(y,k1.y)==<span class="number">0</span>;&#125;</span><br><span class="line">    <span class="comment">// 逆时针旋转 </span></span><br><span class="line">    <span class="function">point <span class="title">turn</span><span class="params">(db k1)</span></span>&#123;<span class="keyword">return</span> (point)&#123;x*<span class="built_in">cos</span>(k1)-y*<span class="built_in">sin</span>(k1),x*<span class="built_in">sin</span>(k1)+y*<span class="built_in">cos</span>(k1)&#125;;&#125;</span><br><span class="line">    <span class="function">point <span class="title">turn90</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> (point)&#123;-y,x&#125;;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> point k1) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a=cmp(x,k1.x);</span><br><span class="line">        <span class="keyword">if</span> (a==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">if</span> (a==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="keyword">else</span> <span class="keyword">return</span> cmp(y,k1.y)==<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">db <span class="title">abs</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y);&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs2</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x*x+y*y;&#125;</span><br><span class="line">    <span class="function">db <span class="title">dis</span><span class="params">(point k1)</span></span>&#123;<span class="keyword">return</span> ((*<span class="keyword">this</span>)-k1).<span class="built_in">abs</span>();&#125;</span><br><span class="line">    <span class="function">point <span class="title">unit</span><span class="params">()</span></span>&#123;db w=<span class="built_in">abs</span>(); <span class="keyword">return</span> (point)&#123;x/w,y/w&#125;;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span></span>&#123;<span class="keyword">double</span> k1,k2; <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>,&amp;k1,&amp;k2); x=k1; y=k2;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;<span class="built_in">printf</span>(<span class="string">"%.11lf %.11lf\n"</span>,x,y);&#125;</span><br><span class="line">    <span class="function">db <span class="title">getw</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">atan2</span>(y,x);&#125; </span><br><span class="line">    <span class="function">point <span class="title">getdel</span><span class="params">()</span></span>&#123;<span class="keyword">if</span> (sign(x)==<span class="number">-1</span>||(sign(x)==<span class="number">0</span>&amp;&amp;sign(y)==<span class="number">-1</span>)) <span class="keyword">return</span> (*<span class="keyword">this</span>)*(<span class="number">-1</span>); <span class="keyword">else</span> <span class="keyword">return</span> (*<span class="keyword">this</span>);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getP</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;<span class="keyword">return</span> sign(y)==<span class="number">1</span>||(sign(y)==<span class="number">0</span>&amp;&amp;sign(x)==<span class="number">-1</span>);&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inmid</span><span class="params">(point k1,point k2,point k3)</span></span>&#123;<span class="keyword">return</span> inmid(k1.x,k2.x,k3.x)&amp;&amp;inmid(k1.y,k2.y,k3.y);&#125;</span><br><span class="line"><span class="function">db <span class="title">cross</span><span class="params">(point k1,point k2)</span></span>&#123;<span class="keyword">return</span> k1.x*k2.y-k1.y*k2.x;&#125;</span><br><span class="line"><span class="function">db <span class="title">dot</span><span class="params">(point k1,point k2)</span></span>&#123;<span class="keyword">return</span> k1.x*k2.x+k1.y*k2.y;&#125;</span><br><span class="line"><span class="function">db <span class="title">rad</span><span class="params">(point k1,point k2)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">atan2</span>(cross(k1,k2),dot(k1,k2));&#125;</span><br><span class="line"><span class="comment">// -pi -&gt; pi</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compareangle</span> <span class="params">(point k1,point k2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> k1.getP()&lt;k2.getP()||(k1.getP()==k2.getP()&amp;&amp;sign(cross(k1,k2))&gt;<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">point <span class="title">proj</span><span class="params">(point k1,point k2,point q)</span></span>&#123; <span class="comment">// q 到直线 k1,k2 的投影 </span></span><br><span class="line">    point k=k2-k1; <span class="keyword">return</span> k1+k*(dot(q-k1,k)/k.abs2());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">point <span class="title">reflect</span><span class="params">(point k1,point k2,point q)</span></span>&#123;<span class="keyword">return</span> proj(k1,k2,q)*<span class="number">2</span>-q;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">clockwise</span><span class="params">(point k1,point k2,point k3)</span></span>&#123;<span class="comment">// k1 k2 k3 逆时针 1 顺时针 -1 否则 0  </span></span><br><span class="line">    <span class="keyword">return</span> sign(cross(k2-k1,k3-k1));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkLL</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;<span class="comment">// 求直线 (L) 线段 (S)k1,k2 和 k3,k4 的交点 </span></span><br><span class="line">    <span class="keyword">return</span> cmp(cross(k3-k1,k4-k1),cross(k3-k2,k4-k2))!=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">point <span class="title">getLL</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;</span><br><span class="line">    db w1=cross(k1-k3,k4-k3),w2=cross(k4-k3,k2-k3); <span class="keyword">return</span> (k1*w2+k2*w1)/(w1+w2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">intersect</span><span class="params">(db l1,db r1,db l2,db r2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l1&gt;r1) swap(l1,r1); <span class="keyword">if</span> (l2&gt;r2) swap(l2,r2); <span class="keyword">return</span> cmp(r1,l2)!=<span class="number">-1</span>&amp;&amp;cmp(r2,l1)!=<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkSS</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> intersect(k1.x,k2.x,k3.x,k4.x)&amp;&amp;intersect(k1.y,k2.y,k3.y,k4.y)&amp;&amp;</span><br><span class="line">    sign(cross(k3-k1,k4-k1))*sign(cross(k3-k2,k4-k2))&lt;=<span class="number">0</span>&amp;&amp;</span><br><span class="line">    sign(cross(k1-k3,k2-k3))*sign(cross(k1-k4,k2-k4))&lt;=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disSP</span><span class="params">(point k1,point k2,point q)</span></span>&#123;</span><br><span class="line">    point k3=proj(k1,k2,q);</span><br><span class="line">    <span class="keyword">if</span> (inmid(k1,k2,k3)) <span class="keyword">return</span> q.dis(k3); <span class="keyword">else</span> <span class="keyword">return</span> min(q.dis(k1),q.dis(k2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disSS</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (checkSS(k1,k2,k3,k4)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> min(min(disSP(k1,k2,k3),disSP(k1,k2,k4)),min(disSP(k3,k4,k1),disSP(k3,k4,k2)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">onS</span><span class="params">(point k1,point k2,point q)</span></span>&#123;<span class="keyword">return</span> inmid(k1,k2,q)&amp;&amp;sign(cross(k1-q,k2-k1))==<span class="number">0</span>;&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">circle</span>&#123;</span></span><br><span class="line">    point o; db r;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span></span>&#123;o.scan(); <span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;r);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">inside</span><span class="params">(point k)</span></span>&#123;<span class="keyword">return</span> cmp(r,o.dis(k));&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span>&#123;</span></span><br><span class="line">    <span class="comment">// p[0]-&gt;p[1]</span></span><br><span class="line">    point p[<span class="number">2</span>];</span><br><span class="line">    line(point k1,point k2)&#123;p[<span class="number">0</span>]=k1; p[<span class="number">1</span>]=k2;&#125;</span><br><span class="line">    point&amp; <span class="keyword">operator</span> [] (<span class="keyword">int</span> k)&#123;<span class="keyword">return</span> p[k];&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">include</span><span class="params">(point k)</span></span>&#123;<span class="keyword">return</span> sign(cross(p[<span class="number">1</span>]-p[<span class="number">0</span>],k-p[<span class="number">0</span>]))&gt;<span class="number">0</span>;&#125;</span><br><span class="line">    <span class="function">point <span class="title">dir</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> p[<span class="number">1</span>]-p[<span class="number">0</span>];&#125;</span><br><span class="line">    <span class="function">line <span class="title">push</span><span class="params">()</span></span>&#123; <span class="comment">// 向外 ( 左手边 ) 平移 eps </span></span><br><span class="line">        <span class="keyword">const</span> db eps = <span class="number">1e-6</span>;</span><br><span class="line">        point delta=(p[<span class="number">1</span>]-p[<span class="number">0</span>]).turn90().unit()*eps;</span><br><span class="line">        <span class="keyword">return</span> &#123;p[<span class="number">0</span>]-delta,p[<span class="number">1</span>]-delta&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">point <span class="title">getLL</span><span class="params">(line k1,line k2)</span></span>&#123;<span class="keyword">return</span> getLL(k1[<span class="number">0</span>],k1[<span class="number">1</span>],k2[<span class="number">0</span>],k2[<span class="number">1</span>]);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">parallel</span><span class="params">(line k1,line k2)</span></span>&#123;<span class="keyword">return</span> sign(cross(k1.dir(),k2.dir()))==<span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sameDir</span><span class="params">(line k1,line k2)</span></span>&#123;<span class="keyword">return</span> parallel(k1,k2)&amp;&amp;sign(dot(k1.dir(),k2.dir()))==<span class="number">1</span>;&#125;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">operator</span> &lt; (line k1,line k2)&#123;</span><br><span class="line">    <span class="keyword">if</span> (sameDir(k1,k2)) <span class="keyword">return</span> k2.include(k1[<span class="number">0</span>]); </span><br><span class="line">    <span class="keyword">return</span> compareangle(k1.dir(),k2.dir());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkpos</span><span class="params">(line k1,line k2,line k3)</span></span>&#123;<span class="keyword">return</span> k3.include(getLL(k1,k2));&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; getHL(<span class="built_in">vector</span>&lt;line&gt; &amp;L)&#123; <span class="comment">// 求半平面交 , 半平面是逆时针方向 , 输出按照逆时针</span></span><br><span class="line">    sort(L.begin(),L.end()); <span class="built_in">deque</span>&lt;line&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;(<span class="keyword">int</span>)L.size();i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (i&amp;&amp;sameDir(L[i],L[i<span class="number">-1</span>])) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (q.size()&gt;<span class="number">1</span>&amp;&amp;!checkpos(q[q.size()<span class="number">-2</span>],q[q.size()<span class="number">-1</span>],L[i])) q.pop_back();</span><br><span class="line">        <span class="keyword">while</span> (q.size()&gt;<span class="number">1</span>&amp;&amp;!checkpos(q[<span class="number">1</span>],q[<span class="number">0</span>],L[i])) q.pop_front();</span><br><span class="line">        q.push_back(L[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q.size()&gt;<span class="number">2</span>&amp;&amp;!checkpos(q[q.size()<span class="number">-2</span>],q[q.size()<span class="number">-1</span>],q[<span class="number">0</span>])) q.pop_back();</span><br><span class="line">    <span class="keyword">while</span> (q.size()&gt;<span class="number">2</span>&amp;&amp;!checkpos(q[<span class="number">1</span>],q[<span class="number">0</span>],q[q.size()<span class="number">-1</span>])) q.pop_front();</span><br><span class="line">    <span class="built_in">vector</span>&lt;line&gt;ans; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;q.size();i++) ans.push_back(q[i]);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">closepoint</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;&amp;A,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123; <span class="comment">// 最近点对 , 先要按照 x 坐标排序 </span></span><br><span class="line">    <span class="keyword">if</span> (r-l&lt;=<span class="number">5</span>)&#123;</span><br><span class="line">        db ans=<span class="number">1e20</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=l;i&lt;=r;i++) <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=r;j++) ans=min(ans,A[i].dis(A[j]));</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; db ans=min(closepoint(A,l,mid),closepoint(A,mid+<span class="number">1</span>,r));</span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;B; <span class="keyword">for</span> (<span class="keyword">int</span> i=l;i&lt;=r;i++) <span class="keyword">if</span> (<span class="built_in">abs</span>(A[i].x-A[mid].x)&lt;=ans) B.push_back(A[i]);</span><br><span class="line">    sort(B.begin(),B.end(),[](point k1,point k2)&#123;<span class="keyword">return</span> k1.y&lt;k2.y;&#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;B.size();i++) <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;B.size()&amp;&amp;B[j].y-B[i].y&lt;ans;j++) ans=min(ans,B[i].dis(B[j]));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkposCC</span><span class="params">(circle k1,circle k2)</span></span>&#123;<span class="comment">// 返回两个圆的公切线数量</span></span><br><span class="line">    <span class="keyword">if</span> (cmp(k1.r,k2.r)==<span class="number">-1</span>) swap(k1,k2);</span><br><span class="line">    db dis=k1.o.dis(k2.o);  <span class="keyword">int</span> w1=cmp(dis,k1.r+k2.r),w2=cmp(dis,k1.r-k2.r);</span><br><span class="line">    <span class="keyword">if</span> (w1&gt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">4</span>; <span class="keyword">else</span> <span class="keyword">if</span> (w1==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">3</span>; <span class="keyword">else</span> <span class="keyword">if</span> (w2&gt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">2</span>; </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (w2==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; getCL(circle k1,point k2,point k3)&#123; <span class="comment">// 沿着 k2-&gt;k3 方向给出 , 相切给出两个 </span></span><br><span class="line">    point k=proj(k2,k3,k1.o); db d=k1.r*k1.r-(k-k1.o).abs2();</span><br><span class="line">    <span class="keyword">if</span> (sign(d)==<span class="number">-1</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    point del=(k3-k2).unit()*<span class="built_in">sqrt</span>(max((db)<span class="number">0.0</span>,d)); <span class="keyword">return</span> &#123;k-del,k+del&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; getCC(circle k1,circle k2)&#123;<span class="comment">// 沿圆 k1 逆时针给出 , 相切给出两个 </span></span><br><span class="line">    <span class="keyword">int</span> pd=checkposCC(k1,k2); <span class="keyword">if</span> (pd==<span class="number">0</span>||pd==<span class="number">4</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    db a=(k2.o-k1.o).abs2(),cosA=(k1.r*k1.r+a-k2.r*k2.r)/(<span class="number">2</span>*k1.r*<span class="built_in">sqrt</span>(max(a,(db)<span class="number">0.0</span>)));</span><br><span class="line">    db b=k1.r*cosA,c=<span class="built_in">sqrt</span>(max((db)<span class="number">0.0</span>,k1.r*k1.r-b*b));</span><br><span class="line">    point k=(k2.o-k1.o).unit(),m=k1.o+k*b,del=k.turn90()*c;</span><br><span class="line">    <span class="keyword">return</span> &#123;m-del,m+del&#125;;</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; TangentCP(circle k1,point k2)&#123;<span class="comment">// 沿圆 k1 逆时针给出 </span></span><br><span class="line">    db a=(k2-k1.o).<span class="built_in">abs</span>(),b=k1.r*k1.r/a,c=<span class="built_in">sqrt</span>(max((db)<span class="number">0.0</span>,k1.r*k1.r-b*b));</span><br><span class="line">    point k=(k2-k1.o).unit(),m=k1.o+k*b,del=k.turn90()*c;</span><br><span class="line">    <span class="keyword">return</span> &#123;m-del,m+del&#125;;</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; TangentoutCC(circle k1,circle k2)&#123;</span><br><span class="line">    <span class="keyword">int</span> pd=checkposCC(k1,k2); <span class="keyword">if</span> (pd==<span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;; </span><br><span class="line">    <span class="keyword">if</span> (pd==<span class="number">1</span>)&#123;point k=getCC(k1,k2)[<span class="number">0</span>]; <span class="keyword">return</span> &#123;(line)&#123;k,k&#125;&#125;;&#125;</span><br><span class="line">    <span class="keyword">if</span> (cmp(k1.r,k2.r)==<span class="number">0</span>)&#123;</span><br><span class="line">        point del=(k2.o-k1.o).unit().turn90().getdel();</span><br><span class="line">        <span class="keyword">return</span> &#123;(line)&#123;k1.o-del*k1.r,k2.o-del*k2.r&#125;,(line)&#123;k1.o+del*k1.r,k2.o+del*k2.r&#125;&#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        point p=(k2.o*k1.r-k1.o*k2.r)/(k1.r-k2.r);</span><br><span class="line">        <span class="built_in">vector</span>&lt;point&gt;A=TangentCP(k1,p),B=TangentCP(k2,p);</span><br><span class="line">        <span class="built_in">vector</span>&lt;line&gt;ans; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) ans.push_back((line)&#123;A[i],B[i]&#125;); </span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; TangentinCC(circle k1,circle k2)&#123;</span><br><span class="line">    <span class="keyword">int</span> pd=checkposCC(k1,k2); <span class="keyword">if</span> (pd&lt;=<span class="number">2</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (pd==<span class="number">3</span>)&#123;point k=getCC(k1,k2)[<span class="number">0</span>]; <span class="keyword">return</span> &#123;(line)&#123;k,k&#125;&#125;;&#125; </span><br><span class="line">    point p=(k2.o*k1.r+k1.o*k2.r)/(k1.r+k2.r);</span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;A=TangentCP(k1,p),B=TangentCP(k2,p);</span><br><span class="line">    <span class="built_in">vector</span>&lt;line&gt;ans; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) ans.push_back((line)&#123;A[i],B[i]&#125;); </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; TangentCC(circle k1,circle k2)&#123;</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">0</span>; <span class="keyword">if</span> (k1.r&lt;k2.r) swap(k1,k2),flag=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;line&gt;A=TangentoutCC(k1,k2),B=TangentinCC(k1,k2);</span><br><span class="line">    <span class="keyword">for</span> (line k:B) A.push_back(k); </span><br><span class="line">    <span class="keyword">if</span> (flag) <span class="keyword">for</span> (line &amp;k:A) swap(k[<span class="number">0</span>],k[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">getarea</span><span class="params">(circle k1,point k2,point k3)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 圆 k1 与三角形 k2 k3 k1.o 的有向面积交</span></span><br><span class="line">    point k=k1.o; k1.o=k1.o-k; k2=k2-k; k3=k3-k;</span><br><span class="line">    <span class="keyword">int</span> pd1=k1.inside(k2),pd2=k1.inside(k3); </span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;A=getCL(k1,k2,k3);</span><br><span class="line">    <span class="keyword">if</span> (pd1&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (pd2&gt;=<span class="number">0</span>) <span class="keyword">return</span> cross(k2,k3)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> k1.r*k1.r*rad(A[<span class="number">1</span>],k3)/<span class="number">2</span>+cross(k2,A[<span class="number">1</span>])/<span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pd2&gt;=<span class="number">0</span>)&#123; </span><br><span class="line">        <span class="keyword">return</span> k1.r*k1.r*rad(k2,A[<span class="number">0</span>])/<span class="number">2</span>+cross(A[<span class="number">0</span>],k3)/<span class="number">2</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> pd=cmp(k1.r,disSP(k2,k3,k1.o));</span><br><span class="line">        <span class="keyword">if</span> (pd&lt;=<span class="number">0</span>) <span class="keyword">return</span> k1.r*k1.r*rad(k2,k3)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> cross(A[<span class="number">0</span>],A[<span class="number">1</span>])/<span class="number">2</span>+k1.r*k1.r*(rad(k2,A[<span class="number">0</span>])+rad(A[<span class="number">1</span>],k3))/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">circle <span class="title">getcircle</span><span class="params">(point k1,point k2,point k3)</span></span>&#123;</span><br><span class="line">    db a1=k2.x-k1.x,b1=k2.y-k1.y,c1=(a1*a1+b1*b1)/<span class="number">2</span>;</span><br><span class="line">    db a2=k3.x-k1.x,b2=k3.y-k1.y,c2=(a2*a2+b2*b2)/<span class="number">2</span>;</span><br><span class="line">    db d=a1*b2-a2*b1;</span><br><span class="line">    point o=(point)&#123;k1.x+(c1*b2-c2*b1)/d,k1.y+(a1*c2-a2*c1)/d&#125;;</span><br><span class="line">    <span class="keyword">return</span> (circle)&#123;o,k1.dis(o)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">circle <span class="title">getScircle</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt; A)</span></span>&#123;</span><br><span class="line">    random_shuffle(A.begin(),A.end());</span><br><span class="line">    circle ans=(circle)&#123;A[<span class="number">0</span>],<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.size();i++)</span><br><span class="line">        <span class="keyword">if</span> (ans.inside(A[i])==<span class="number">-1</span>)&#123;</span><br><span class="line">            ans=(circle)&#123;A[i],<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)</span><br><span class="line">                <span class="keyword">if</span> (ans.inside(A[j])==<span class="number">-1</span>)&#123;</span><br><span class="line">                    ans.o=(A[i]+A[j])/<span class="number">2</span>; ans.r=ans.o.dis(A[i]);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;j;k++)</span><br><span class="line">                        <span class="keyword">if</span> (ans.inside(A[k])==<span class="number">-1</span>)</span><br><span class="line">                            ans=getcircle(A[i],A[j],A[k]);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">area</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt; A)</span></span>&#123; <span class="comment">// 多边形用 vector&lt;point&gt; 表示 , 逆时针 </span></span><br><span class="line">    db ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) ans+=cross(A[i],A[(i+<span class="number">1</span>)%A.size()]);</span><br><span class="line">    <span class="keyword">return</span> ans/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkconvex</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n=A.size(); A.push_back(A[<span class="number">0</span>]); A.push_back(A[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) <span class="keyword">if</span> (sign(cross(A[i+<span class="number">1</span>]-A[i],A[i+<span class="number">2</span>]-A[i]))==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">contain</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,point q)</span></span>&#123; <span class="comment">// 2 内部 1 边界 0 外部</span></span><br><span class="line">    <span class="keyword">int</span> pd=<span class="number">0</span>; A.push_back(A[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.size();i++)&#123;</span><br><span class="line">        point u=A[i<span class="number">-1</span>],v=A[i];</span><br><span class="line">        <span class="keyword">if</span> (onS(u,v,q)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">if</span> (cmp(u.y,v.y)&gt;<span class="number">0</span>) swap(u,v);</span><br><span class="line">        <span class="keyword">if</span> (cmp(u.y,q.y)&gt;=<span class="number">0</span>||cmp(v.y,q.y)&lt;<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (sign(cross(u-v,q-v))&lt;<span class="number">0</span>) pd^=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pd&lt;&lt;<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; ConvexHull(<span class="built_in">vector</span>&lt;point&gt;A,<span class="keyword">int</span> flag=<span class="number">1</span>)&#123; <span class="comment">// flag=0 不严格 flag=1 严格 </span></span><br><span class="line">    <span class="keyword">int</span> n=A.size(); <span class="built_in">vector</span>&lt;point&gt;ans(n*<span class="number">2</span>); </span><br><span class="line">    sort(A.begin(),A.end()); <span class="keyword">int</span> now=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++)&#123;</span><br><span class="line">        <span class="keyword">while</span> (now&gt;<span class="number">0</span>&amp;&amp;sign(cross(ans[now]-ans[now<span class="number">-1</span>],A[i]-ans[now<span class="number">-1</span>]))&lt;flag) now--;</span><br><span class="line">        ans[++now]=A[i];</span><br><span class="line">    &#125; <span class="keyword">int</span> pre=now;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=n<span class="number">-2</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">while</span> (now&gt;pre&amp;&amp;sign(cross(ans[now]-ans[now<span class="number">-1</span>],A[i]-ans[now<span class="number">-1</span>]))&lt;flag) now--;</span><br><span class="line">        ans[++now]=A[i];</span><br><span class="line">    &#125; ans.resize(now); <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">convexDiameter</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now=<span class="number">0</span>,n=A.size(); db ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++)&#123;</span><br><span class="line">        now=max(now,i);</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">            db k1=A[i].dis(A[now%n]),k2=A[i].dis(A[(now+<span class="number">1</span>)%n]);</span><br><span class="line">            ans=max(ans,max(k1,k2)); <span class="keyword">if</span> (k2&gt;k1) now++; <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; convexcut(<span class="built_in">vector</span>&lt;point&gt;A,point k1,point k2)&#123;</span><br><span class="line">    <span class="comment">// 保留 k1,k2,p 逆时针的所有点</span></span><br><span class="line">    <span class="keyword">int</span> n=A.size(); A.push_back(A[<span class="number">0</span>]); <span class="built_in">vector</span>&lt;point&gt;ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> w1=clockwise(k1,k2,A[i]),w2=clockwise(k1,k2,A[i+<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (w1&gt;=<span class="number">0</span>) ans.push_back(A[i]);</span><br><span class="line">        <span class="keyword">if</span> (w1*w2&lt;<span class="number">0</span>) ans.push_back(getLL(k1,k2,A[i],A[i+<span class="number">1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkPoS</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,point k1,point k2)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 多边形 A 和直线 ( 线段 )k1-&gt;k2 严格相交 , 注释部分为线段</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ins</span>&#123;</span></span><br><span class="line">        point m,u,v;</span><br><span class="line">        <span class="keyword">int</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> ins&amp; k) <span class="keyword">const</span> &#123;<span class="keyword">return</span> m&lt;k.m;&#125;</span><br><span class="line">    &#125;; <span class="built_in">vector</span>&lt;ins&gt;B;</span><br><span class="line">    <span class="comment">//if (contain(A,k1)==2||contain(A,k2)==2) return 1;</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;poly=A; A.push_back(A[<span class="number">0</span>]); </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.size();i++) <span class="keyword">if</span> (checkLL(A[i<span class="number">-1</span>],A[i],k1,k2))&#123;</span><br><span class="line">        point m=getLL(A[i<span class="number">-1</span>],A[i],k1,k2); </span><br><span class="line">        <span class="keyword">if</span> (inmid(A[i<span class="number">-1</span>],A[i],m)<span class="comment">/*&amp;&amp;inmid(k1,k2,m)*/</span>) B.push_back((ins)&#123;m,A[i<span class="number">-1</span>],A[i]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (B.size()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; sort(B.begin(),B.end()); </span><br><span class="line">    <span class="keyword">int</span> now=<span class="number">1</span>; <span class="keyword">while</span> (now&lt;B.size()&amp;&amp;B[now].m==B[<span class="number">0</span>].m) now++; </span><br><span class="line">    <span class="keyword">if</span> (now==B.size()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flag=contain(poly,(B[<span class="number">0</span>].m+B[now].m)/<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    point d=B[now].m-B[<span class="number">0</span>].m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=now;i&lt;B.size();i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!(B[i].m==B[i<span class="number">-1</span>].m)&amp;&amp;flag==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> tag=sign(cross(B[i].v-B[i].u,B[i].m+d-B[i].u));</span><br><span class="line">        <span class="keyword">if</span> (B[i].m==B[i].u||B[i].m==B[i].v) flag+=tag; <span class="keyword">else</span> flag+=tag*<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//return 0;</span></span><br><span class="line">    <span class="keyword">return</span> flag==<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkinp</span><span class="params">(point r,point l,point m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (compareangle(l,r))&#123;<span class="keyword">return</span> compareangle(l,m)&amp;&amp;compareangle(m,r);&#125;</span><br><span class="line">	<span class="keyword">return</span> compareangle(l,m)||compareangle(m,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkPosFast</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,point k1,point k2)</span></span>&#123; <span class="comment">// 快速检查线段是否和多边形严格相交</span></span><br><span class="line">	<span class="keyword">if</span> (contain(A,k1)==<span class="number">2</span>||contain(A,k2)==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">if</span> (k1==k2) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	A.push_back(A[<span class="number">0</span>]); A.push_back(A[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i+<span class="number">1</span>&lt;A.size();i++)</span><br><span class="line">		<span class="keyword">if</span> (checkLL(A[i<span class="number">-1</span>],A[i],k1,k2))&#123;</span><br><span class="line">			point now=getLL(A[i<span class="number">-1</span>],A[i],k1,k2);</span><br><span class="line">			<span class="keyword">if</span> (inmid(A[i<span class="number">-1</span>],A[i],now)==<span class="number">0</span>||inmid(k1,k2,now)==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (now==A[i])&#123;</span><br><span class="line">				<span class="keyword">if</span> (A[i]==k2) <span class="keyword">continue</span>;</span><br><span class="line">				point pre=A[i<span class="number">-1</span>],ne=A[i+<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">if</span> (checkinp(pre-now,ne-now,k2-now)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (now==k1)&#123;</span><br><span class="line">				<span class="keyword">if</span> (k1==A[i<span class="number">-1</span>]||k1==A[i]) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (checkinp(A[i<span class="number">-1</span>]-k1,A[i]-k1,k2-k1)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (now==k2||now==A[i<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 拆分凸包成上下凸壳 凸包尽量都随机旋转一个角度来避免出现相同横坐标 </span></span><br><span class="line"><span class="comment">// 尽量特判只有一个点的情况 凸包逆时针</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getUDP</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,<span class="built_in">vector</span>&lt;point&gt;&amp;U,<span class="built_in">vector</span>&lt;point&gt;&amp;D)</span></span>&#123;</span><br><span class="line">    db l=<span class="number">1e100</span>,r=<span class="number">-1e100</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) l=min(l,A[i].x),r=max(r,A[i].x);</span><br><span class="line">    <span class="keyword">int</span> wherel,wherer;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) <span class="keyword">if</span> (cmp(A[i].x,l)==<span class="number">0</span>) wherel=i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=A.size();i;i--) <span class="keyword">if</span> (cmp(A[i<span class="number">-1</span>].x,r)==<span class="number">0</span>) wherer=i<span class="number">-1</span>;</span><br><span class="line">    U.clear(); D.clear(); <span class="keyword">int</span> now=wherel;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;D.push_back(A[now]); <span class="keyword">if</span> (now==wherer) <span class="keyword">break</span>; now++; <span class="keyword">if</span> (now&gt;=A.size()) now=<span class="number">0</span>;&#125;</span><br><span class="line">    now=wherel;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;U.push_back(A[now]); <span class="keyword">if</span> (now==wherer) <span class="keyword">break</span>; now--; <span class="keyword">if</span> (now&lt;<span class="number">0</span>) now=A.size()<span class="number">-1</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 需要保证凸包点数大于等于 3,2 内部 ,1 边界 ,0 外部</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">containCoP</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;U,<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;D,point k)</span></span>&#123;</span><br><span class="line">    db lx=U[<span class="number">0</span>].x,rx=U[U.size()<span class="number">-1</span>].x;</span><br><span class="line">    <span class="keyword">if</span> (k==U[<span class="number">0</span>]||k==U[U.size()<span class="number">-1</span>]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (cmp(k.x,lx)==<span class="number">-1</span>||cmp(k.x,rx)==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> where1=lower_bound(U.begin(),U.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-U.begin();</span><br><span class="line">    <span class="keyword">int</span> where2=lower_bound(D.begin(),D.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-D.begin();</span><br><span class="line">    <span class="keyword">int</span> w1=clockwise(U[where1<span class="number">-1</span>],U[where1],k),w2=clockwise(D[where2<span class="number">-1</span>],D[where2],k);</span><br><span class="line">    <span class="keyword">if</span> (w1==<span class="number">1</span>||w2==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="keyword">else</span> <span class="keyword">if</span> (w1==<span class="number">0</span>||w2==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// d 是方向 , 输出上方切点和下方切点</span></span><br><span class="line">pair&lt;point,point&gt; getTangentCow(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt; &amp;U,<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt; &amp;D,point d)&#123;</span><br><span class="line">    <span class="keyword">if</span> (sign(d.x)&lt;<span class="number">0</span>||(sign(d.x)==<span class="number">0</span>&amp;&amp;sign(d.y)&lt;<span class="number">0</span>)) d=d*(<span class="number">-1</span>);</span><br><span class="line">    point whereU,whereD;</span><br><span class="line">    <span class="keyword">if</span> (sign(d.x)==<span class="number">0</span>) <span class="keyword">return</span> mp(U[<span class="number">0</span>],U[U.size()<span class="number">-1</span>]);</span><br><span class="line">    <span class="keyword">int</span> l=<span class="number">0</span>,r=U.size()<span class="number">-1</span>,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (sign(cross(U[mid+<span class="number">1</span>]-U[mid],d))&lt;=<span class="number">0</span>) l=mid+<span class="number">1</span>,ans=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">    whereU=U[ans]; l=<span class="number">0</span>,r=D.size()<span class="number">-1</span>,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (sign(cross(D[mid+<span class="number">1</span>]-D[mid],d))&gt;=<span class="number">0</span>) l=mid+<span class="number">1</span>,ans=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">    whereD=D[ans]; <span class="keyword">return</span> mp(whereU,whereD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 先检查 contain, 逆时针给出</span></span><br><span class="line">pair&lt;point,point&gt; getTangentCoP(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;U,<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;D,point k)&#123;</span><br><span class="line">    db lx=U[<span class="number">0</span>].x,rx=U[U.size()<span class="number">-1</span>].x;</span><br><span class="line">    <span class="keyword">if</span> (k.x&lt;lx)&#123;</span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">0</span>,r=U.size()<span class="number">-1</span>,ans=U.size()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid+<span class="number">1</span>])==<span class="number">1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">        point w1=U[ans]; l=<span class="number">0</span>,r=D.size()<span class="number">-1</span>,ans=D.size()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid+<span class="number">1</span>])==<span class="number">-1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">        point w2=D[ans]; <span class="keyword">return</span> mp(w1,w2);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k.x&gt;rx)&#123;</span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">1</span>,r=U.size(),ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid<span class="number">-1</span>])==<span class="number">-1</span>) r=mid; <span class="keyword">else</span> ans=mid,l=mid+<span class="number">1</span>;&#125;</span><br><span class="line">        point w1=U[ans]; l=<span class="number">1</span>,r=D.size(),ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid<span class="number">-1</span>])==<span class="number">1</span>) r=mid; <span class="keyword">else</span> ans=mid,l=mid+<span class="number">1</span>;&#125;</span><br><span class="line">        point w2=D[ans]; <span class="keyword">return</span> mp(w2,w1);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> where1=lower_bound(U.begin(),U.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-U.begin();</span><br><span class="line">        <span class="keyword">int</span> where2=lower_bound(D.begin(),D.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-D.begin();</span><br><span class="line">        <span class="keyword">if</span> ((k.x==lx&amp;&amp;k.y&gt;U[<span class="number">0</span>].y)||(where1&amp;&amp;clockwise(U[where1<span class="number">-1</span>],U[where1],k)==<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">int</span> l=<span class="number">1</span>,r=where1+<span class="number">1</span>,ans=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid<span class="number">-1</span>])==<span class="number">1</span>) ans=mid,l=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">            point w1=U[ans]; l=where1,r=U.size()<span class="number">-1</span>,ans=U.size()<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid+<span class="number">1</span>])==<span class="number">1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">            point w2=U[ans]; <span class="keyword">return</span> mp(w2,w1);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> l=<span class="number">1</span>,r=where2+<span class="number">1</span>,ans=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid<span class="number">-1</span>])==<span class="number">-1</span>) ans=mid,l=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">            point w1=D[ans]; l=where2,r=D.size()<span class="number">-1</span>,ans=D.size()<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid+<span class="number">1</span>])==<span class="number">-1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">            point w2=D[ans]; <span class="keyword">return</span> mp(w1,w2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">P3</span>&#123;</span></span><br><span class="line">    db x,y,z;</span><br><span class="line">    P3 <span class="keyword">operator</span> + (P3 k1)&#123;<span class="keyword">return</span> (P3)&#123;x+k1.x,y+k1.y,z+k1.z&#125;;&#125;</span><br><span class="line">    P3 <span class="keyword">operator</span> - (P3 k1)&#123;<span class="keyword">return</span> (P3)&#123;x-k1.x,y-k1.y,z-k1.z&#125;;&#125;</span><br><span class="line">    P3 <span class="keyword">operator</span> * (db k1)&#123;<span class="keyword">return</span> (P3)&#123;x*k1,y*k1,z*k1&#125;;&#125;</span><br><span class="line">    P3 <span class="keyword">operator</span> / (db k1)&#123;<span class="keyword">return</span> (P3)&#123;x/k1,y/k1,z/k1&#125;;&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs2</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x*x+y*y+z*z;&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y+z*z);&#125;</span><br><span class="line">    <span class="function">P3 <span class="title">unit</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> (*<span class="keyword">this</span>)/<span class="built_in">abs</span>();&#125;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> P3 k1) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cmp(x,k1.x)!=<span class="number">0</span>) <span class="keyword">return</span> x&lt;k1.x;</span><br><span class="line">        <span class="keyword">if</span> (cmp(y,k1.y)!=<span class="number">0</span>) <span class="keyword">return</span> y&lt;k1.y;</span><br><span class="line">        <span class="keyword">return</span> cmp(z,k1.z)==<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> P3 k1)&#123;</span><br><span class="line">        <span class="keyword">return</span> cmp(x,k1.x)==<span class="number">0</span>&amp;&amp;cmp(y,k1.y)==<span class="number">0</span>&amp;&amp;cmp(z,k1.z)==<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> k1,k2,k3; <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;k1,&amp;k2,&amp;k3);</span><br><span class="line">        x=k1; y=k2; z=k3;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">P3 <span class="title">cross</span><span class="params">(P3 k1,P3 k2)</span></span>&#123;<span class="keyword">return</span> (P3)&#123;k1.y*k2.z-k1.z*k2.y,k1.z*k2.x-k1.x*k2.z,k1.x*k2.y-k1.y*k2.x&#125;;&#125;</span><br><span class="line"><span class="function">db <span class="title">dot</span><span class="params">(P3 k1,P3 k2)</span></span>&#123;<span class="keyword">return</span> k1.x*k2.x+k1.y*k2.y+k1.z*k2.z;&#125;</span><br><span class="line"><span class="comment">//p=(3,4,5),l=(13,19,21),theta=85 ans=(2.83,4.62,1.77)</span></span><br><span class="line"><span class="function">P3 <span class="title">turn3D</span><span class="params">(db k1,P3 l,P3 p)</span></span>&#123;</span><br><span class="line">    l=l.unit(); P3 ans; db c=<span class="built_in">cos</span>(k1),s=<span class="built_in">sin</span>(k1);</span><br><span class="line">    ans.x=p.x*(l.x*l.x*(<span class="number">1</span>-c)+c)+p.y*(l.x*l.y*(<span class="number">1</span>-c)-l.z*s)+p.z*(l.x*l.z*(<span class="number">1</span>-c)+l.y*s);</span><br><span class="line">    ans.y=p.x*(l.x*l.y*(<span class="number">1</span>-c)+l.z*s)+p.y*(l.y*l.y*(<span class="number">1</span>-c)+c)+p.z*(l.y*l.z*(<span class="number">1</span>-c)-l.x*s);</span><br><span class="line">    ans.z=p.x*(l.x*l.z*(<span class="number">1</span>-c)-l.y*s)+p.y*(l.y*l.z*(<span class="number">1</span>-c)+l.x*s)+p.z*(l.x*l.x*(<span class="number">1</span>-c)+c);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;P3&gt; VP;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;VP&gt; VVP;</span><br><span class="line"><span class="function">db <span class="title">Acos</span><span class="params">(db x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">acos</span>(max(-(db)<span class="number">1</span>,min(x,(db)<span class="number">1</span>)));&#125;</span><br><span class="line"><span class="comment">// 球面距离 , 圆心原点 , 半径 1</span></span><br><span class="line"><span class="function">db <span class="title">Odist</span><span class="params">(P3 a,P3 b)</span></span>&#123;db r=Acos(dot(a,b)); <span class="keyword">return</span> r;&#125;</span><br><span class="line">db r; P3 rnd;</span><br><span class="line"><span class="built_in">vector</span>&lt;db&gt; solve(db a,db b,db c)&#123;</span><br><span class="line">    db r=<span class="built_in">sqrt</span>(a*a+b*b),th=<span class="built_in">atan2</span>(b,a);</span><br><span class="line">    <span class="keyword">if</span> (cmp(c,-r)==<span class="number">-1</span>) <span class="keyword">return</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp(r,c)&lt;=<span class="number">0</span>) <span class="keyword">return</span> &#123;<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        db tr=pi-Acos(c/r); <span class="keyword">return</span> &#123;th+pi-tr,th+pi+tr&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;db&gt; jiao(P3 a,P3 b)&#123;</span><br><span class="line">    <span class="comment">// dot(rd+x*cos(t)+y*sin(t),b) &gt;= cos(r)</span></span><br><span class="line">    <span class="keyword">if</span> (cmp(Odist(a,b),<span class="number">2</span>*r)&gt;<span class="number">0</span>) <span class="keyword">return</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    P3 rd=a*<span class="built_in">cos</span>(r),z=a.unit(),y=cross(z,rnd).unit(),x=cross(y,z).unit();</span><br><span class="line">    <span class="built_in">vector</span>&lt;db&gt; ret = solve(-(dot(x,b)*<span class="built_in">sin</span>(r)),-(dot(y,b)*<span class="built_in">sin</span>(r)),-(<span class="built_in">cos</span>(r)-dot(rd,b))); </span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">norm</span><span class="params">(db x,db l=<span class="number">0</span>,db r=<span class="number">2</span>*pi)</span></span>&#123; <span class="comment">// change x into [l,r)</span></span><br><span class="line">    <span class="keyword">while</span> (cmp(x,l)==<span class="number">-1</span>) x+=(r-l); <span class="keyword">while</span> (cmp(x,r)&gt;=<span class="number">0</span>) x-=(r-l);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disLP</span><span class="params">(P3 k1,P3 k2,P3 q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (cross(k2-k1,q-k1)).<span class="built_in">abs</span>()/(k2-k1).<span class="built_in">abs</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disLL</span><span class="params">(P3 k1,P3 k2,P3 k3,P3 k4)</span></span>&#123;</span><br><span class="line">    P3 dir=cross(k2-k1,k4-k3); <span class="keyword">if</span> (sign(dir.<span class="built_in">abs</span>())==<span class="number">0</span>) <span class="keyword">return</span> disLP(k1,k2,k3);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(dot(dir.unit(),k1-k2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VP <span class="title">getFL</span><span class="params">(P3 p,P3 dir,P3 k1,P3 k2)</span></span>&#123;</span><br><span class="line">    db a=dot(k2-p,dir),b=dot(k1-p,dir),d=a-b;</span><br><span class="line">    <span class="keyword">if</span> (sign(<span class="built_in">fabs</span>(d))==<span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;(k1*a-k2*b)/d&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VP <span class="title">getFF</span><span class="params">(P3 p1,P3 dir1,P3 p2,P3 dir2)</span></span>&#123;<span class="comment">// 返回一条线</span></span><br><span class="line">    P3 e=cross(dir1,dir2),v=cross(dir1,e);</span><br><span class="line">    db d=dot(dir2,v); <span class="keyword">if</span> (sign(<span class="built_in">abs</span>(d))==<span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    P3 q=p1+v*dot(dir2,p2-p1)/d; <span class="keyword">return</span> &#123;q,q+e&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3D Covex Hull Template</span></span><br><span class="line"><span class="function">db <span class="title">getV</span><span class="params">(P3 k1,P3 k2,P3 k3,P3 k4)</span></span>&#123; <span class="comment">// get the Volume</span></span><br><span class="line">    <span class="keyword">return</span> dot(cross(k2-k1,k3-k1),k4-k1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">rand_db</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="number">1.0</span>*rand()/RAND_MAX;&#125;</span><br><span class="line"><span class="function">VP <span class="title">convexHull2D</span><span class="params">(VP A,P3 dir)</span></span>&#123;</span><br><span class="line">    P3 x=&#123;(db)rand(),(db)rand(),(db)rand()&#125;; x=x.unit();</span><br><span class="line">    x=cross(x,dir).unit(); P3 y=cross(x,dir).unit();</span><br><span class="line">    P3 vec=dir.unit()*dot(A[<span class="number">0</span>],dir);</span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;B;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) B.push_back((point)&#123;dot(A[i],x),dot(A[i],y)&#125;);</span><br><span class="line">    B=ConvexHull(B); A.clear();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;B.size();i++) A.push_back(x*B[i].x+y*B[i].y+vec);</span><br><span class="line">    <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> CH3&#123;</span><br><span class="line">    VVP ret; <span class="built_in">set</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt;e;</span><br><span class="line">    <span class="keyword">int</span> n; VP p,q;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">wrap</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e.find(&#123;a,b&#125;)==e.end())&#123;</span><br><span class="line">            <span class="keyword">int</span> c=<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) <span class="keyword">if</span> (i!=a&amp;&amp;i!=b)&#123;</span><br><span class="line">                <span class="keyword">if</span> (c==<span class="number">-1</span>||sign(getV(q[c],q[a],q[b],q[i]))&gt;<span class="number">0</span>) c=i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (c!=<span class="number">-1</span>)&#123;</span><br><span class="line">                ret.push_back(&#123;p[a],p[b],p[c]&#125;);</span><br><span class="line">                e.insert(&#123;a,b&#125;); e.insert(&#123;b,c&#125;); e.insert(&#123;c,a&#125;);</span><br><span class="line">                wrap(c,b); wrap(a,c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">VVP <span class="title">ConvexHull3D</span><span class="params">(VP _p)</span></span>&#123;</span><br><span class="line">        p=q=_p; n=p.size();</span><br><span class="line">        ret.clear(); e.clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i:q) i=i+(P3)&#123;rand_db()*<span class="number">1e-4</span>,rand_db()*<span class="number">1e-4</span>,rand_db()*<span class="number">1e-4</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++) <span class="keyword">if</span> (q[i].x&lt;q[<span class="number">0</span>].x) swap(p[<span class="number">0</span>],p[i]),swap(q[<span class="number">0</span>],q[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;n;i++) <span class="keyword">if</span> ((q[i].x-q[<span class="number">0</span>].x)*(q[<span class="number">1</span>].y-q[<span class="number">0</span>].y)&gt;(q[i].y-q[<span class="number">0</span>].y)*(q[<span class="number">1</span>].x-q[<span class="number">0</span>].x)) swap(q[<span class="number">1</span>],q[i]),swap(p[<span class="number">1</span>],p[i]);</span><br><span class="line">        wrap(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VVP <span class="title">reduceCH</span><span class="params">(VVP A)</span></span>&#123;</span><br><span class="line">    VVP ret; <span class="built_in">map</span>&lt;P3,VP&gt; M;</span><br><span class="line">    <span class="keyword">for</span> (VP nowF:A)&#123;</span><br><span class="line">        P3 dir=cross(nowF[<span class="number">1</span>]-nowF[<span class="number">0</span>],nowF[<span class="number">2</span>]-nowF[<span class="number">0</span>]).unit();</span><br><span class="line">        <span class="keyword">for</span> (P3 k1:nowF) M[dir].pb(k1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (pair&lt;P3,VP&gt; nowF:M) ret.pb(convexHull2D(nowF.se,nowF.fi));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  把一个面变成 ( 点 , 法向量 ) 的形式</span></span><br><span class="line">pair&lt;P3,P3&gt; getF(VP F)&#123;</span><br><span class="line">    <span class="keyword">return</span> mp(F[<span class="number">0</span>],cross(F[<span class="number">1</span>]-F[<span class="number">0</span>],F[<span class="number">2</span>]-F[<span class="number">0</span>]).unit());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3D Cut 保留 dot(dir,x-p)&gt;=0 的部分</span></span><br><span class="line"><span class="function">VVP <span class="title">ConvexCut3D</span><span class="params">(VVP A,P3 p,P3 dir)</span></span>&#123;</span><br><span class="line">    VVP ret; VP sec;</span><br><span class="line">    <span class="keyword">for</span> (VP nowF: A)&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nowF.size(); VP ans; <span class="keyword">int</span> dif=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> d1=sign(dot(dir,nowF[i]-p));</span><br><span class="line">            <span class="keyword">int</span> d2=sign(dot(dir,nowF[(i+<span class="number">1</span>)%n]-p));</span><br><span class="line">            <span class="keyword">if</span> (d1&gt;=<span class="number">0</span>) ans.pb(nowF[i]);</span><br><span class="line">            <span class="keyword">if</span> (d1*d2&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                P3 q=getFL(p,dir,nowF[i],nowF[(i+<span class="number">1</span>)%n])[<span class="number">0</span>];</span><br><span class="line">                ans.push_back(q); sec.push_back(q);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (d1==<span class="number">0</span>) sec.push_back(nowF[i]); <span class="keyword">else</span> dif=<span class="number">1</span>;</span><br><span class="line">            dif|=(sign(dot(dir,cross(nowF[(i+<span class="number">1</span>)%n]-nowF[i],nowF[(i+<span class="number">1</span>)%n]-nowF[i])))==<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ans.size()&gt;<span class="number">0</span>&amp;&amp;dif) ret.push_back(ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sec.size()&gt;<span class="number">0</span>) ret.push_back(convexHull2D(sec,dir));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">vol</span><span class="params">(VVP A)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (A.size()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; P3 p=A[<span class="number">0</span>][<span class="number">0</span>]; db ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (VP nowF:A)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;nowF.size();i++)</span><br><span class="line">            ans+=<span class="built_in">abs</span>(getV(p,nowF[<span class="number">0</span>],nowF[i<span class="number">-1</span>],nowF[i]));</span><br><span class="line">    <span class="keyword">return</span> ans/<span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VVP <span class="title">init</span><span class="params">(db INF)</span> </span>&#123;</span><br><span class="line">    VVP pss(6,VP(4));</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">0</span>] = pss[<span class="number">1</span>][<span class="number">0</span>] = pss[<span class="number">2</span>][<span class="number">0</span>] = &#123;-INF, -INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">3</span>] = pss[<span class="number">1</span>][<span class="number">1</span>] = pss[<span class="number">5</span>][<span class="number">2</span>] = &#123;-INF, -INF, INF&#125;;</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">1</span>] = pss[<span class="number">2</span>][<span class="number">3</span>] = pss[<span class="number">4</span>][<span class="number">2</span>] = &#123;-INF, INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">2</span>] = pss[<span class="number">5</span>][<span class="number">3</span>] = pss[<span class="number">4</span>][<span class="number">1</span>] = &#123;-INF, INF, INF&#125;;</span><br><span class="line">    pss[<span class="number">1</span>][<span class="number">3</span>] = pss[<span class="number">2</span>][<span class="number">1</span>] = pss[<span class="number">3</span>][<span class="number">2</span>] = &#123;INF, -INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">1</span>][<span class="number">2</span>] = pss[<span class="number">5</span>][<span class="number">1</span>] = pss[<span class="number">3</span>][<span class="number">3</span>] = &#123;INF, -INF, INF&#125;;</span><br><span class="line">    pss[<span class="number">2</span>][<span class="number">2</span>] = pss[<span class="number">4</span>][<span class="number">3</span>] = pss[<span class="number">3</span>][<span class="number">1</span>] = &#123;INF, INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">5</span>][<span class="number">0</span>] = pss[<span class="number">4</span>][<span class="number">0</span>] = pss[<span class="number">3</span>][<span class="number">0</span>] = &#123;INF, INF, INF&#125;;</span><br><span class="line">    <span class="keyword">return</span> pss;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/计算几何/" rel="tag"># 计算几何</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/28/线段树模板/" rel="next" title="线段树模板">
                <i class="fa fa-chevron-left"></i> 线段树模板
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/01/30/Camp-Day8-A-Aqous/" rel="prev" title="Camp Day8 A Aqous">
                Camp Day8 A Aqous <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">嗷嗷嗷</p>
              <p class="site-description motion-element" itemprop="description">ACM, 数学, 编程, 怪物猎人(?)</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#题意描述"><span class="nav-number">1.</span> <span class="nav-text">题意描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Input"><span class="nav-number">2.</span> <span class="nav-text">Input</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Output"><span class="nav-number">3.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sample-Input"><span class="nav-number">4.</span> <span class="nav-text">Sample Input</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sample-Output"><span class="nav-number">5.</span> <span class="nav-text">Sample Output</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#题意："><span class="nav-number">6.</span> <span class="nav-text">题意：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码："><span class="nav-number">7.</span> <span class="nav-text">代码：</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">嗷嗷嗷</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  


  

  

</body>
</html>
