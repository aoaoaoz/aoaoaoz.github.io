<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">






  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="ACM, 数学, 编程, 怪物猎人(?)">
<meta property="og:type" content="website">
<meta property="og:title" content="嗷嗷嗷&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="嗷嗷嗷&#39;s Blog">
<meta property="og:description" content="ACM, 数学, 编程, 怪物猎人(?)">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="嗷嗷嗷&#39;s Blog">
<meta name="twitter:description" content="ACM, 数学, 编程, 怪物猎人(?)">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>嗷嗷嗷's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">嗷嗷嗷's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">aoaoao's Blog</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/30/Camp-Day8-A-Aqous/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/30/Camp-Day8-A-Aqous/" itemprop="url">Camp Day8 A Aqous</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-30T11:03:58+08:00">
                2019-01-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><p>Aqours 正在 LoveLive! 决赛中表演，舞台可以看作是一棵 $n$ 个点的有根树，其中根节点是 1 号点，$i$ 号点的父亲节点为 $p_i$ ，保证 $1 \le p_i &lt; i$ ，而且对于 $2 \le i &lt; j $\le n^2$ 有 $p_i \le p_j$ 。<br>其中的叶子节点（定义为没有孩子节点的点）是与粉丝进行互动的节点，Aqours 会在这些叶子节点之间走动来与更多的粉丝互动，但是她们又要唱歌又要跳舞，要尽快节省走动时间，然后也要做到雨露均沾，所以每次要往编号更小的叶子节点走。<br>所以 Aqours 想知道对于每一个叶子节点 $u$ ，离它最近的编号 $&lt;u$ 的叶子节点到它的距离是多少，若不存在则视距离为 -1。</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><p>第一行一个正整数 n ( $1 \le n \le 3 \times 10^6$ )，表示树的大小。<br>第二行 $n-1$ 个正整数，其中第 $i$ 个数表示 $p_{i+1}(1 \le p_{i+1} \le i)$ 。对于 $2 \le i &lt; j \le n^2$ ，保证 $p_i \le p_j$  。</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><p>每个叶子对应的答案输出一行。每行第一个数是叶子节点的编号 $u$，第二个数是离他最近的编号 $&lt;u$ 的叶子节点到它的距离，若不存在则输出 -1。<br>要求按叶子节点编号从小到大输出。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><p>10<br>1 1 1 1 2 4 5 6 7</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><p>3 -1<br>8 3<br>9 4<br>10 4</p>
<h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>按BFS序给出一个树，求出每个叶子节点到所有标号比他小的叶子节点的最小距离，其中距离就是常规的树的路径的距离。如果不存在就输出-1.</p>
<h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a><strong>思路：</strong></h2><p>显然是按BFS序给出这个树的，所以可以知道编号小的叶子节点的深度绝对不会大于标号比它大的节点。对每个节点 $u$ 维护一个值 $dis(u)$ 表示离u最近的叶子节点到他的距离。初始时每个dis初始化为0， $dis(0)$ 初始化为INF。按照从小到大的顺序枚举每个叶子节点，然后从每个叶子节点一直往上更新dis(f(u))，同时将访问到的节点塞进栈里，直到某个节点的dis曾经被更新过。然后该节点的答案就是往上跳的步数加上这个节点的dis值。由于所有比目前的叶子节点标号都小的叶子节点都已经访问过了，所以目前跳到的答案一定是最优的。而往下更新的原因是因为可能比较浅的节点到该节点的距离更小。需要注意的是这里最好用数组模拟栈，用自带的栈我一直TLE。感觉效率差了一个数量级。</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ull unsigned long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> what_is(x) cerr &lt;&lt;  <span class="meta-string">"Line "</span> &lt;&lt; __LINE__ &lt;&lt; <span class="meta-string">": "</span> &lt;&lt; #x &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; endl;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> suf_zero(x) __builtin_ffs(x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pre_zero(x) __builtin_clz(x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> num_one(x) __builtin_popcount(x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> <span class="meta-keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="meta-string">','</span>, <span class="meta-string">' '</span>); stringstream _ss(_s); istream_iterator<span class="meta-string">&lt;string&gt; _it(_ss); err(_it, args); &#125;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mt make_tuple</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eb emplace_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INFI 2000000009</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INFLL (ll)1e18+7</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ig ignore</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TP tuple<span class="meta-string">&lt;int, int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l, m, rt&lt;&lt;1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1, r, rt&lt;&lt;1|1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="comment">//#define rep(i, begin, end) for(__typeof(end) i =(begin)-((begin)&gt;(end));i!=(end)-((begin)&gt;(end));i+=1-2*((begin)&gt;(end)))</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;<span class="built_in">string</span>&gt; it)</span> </span>&#123;<span class="built_in">cerr</span>&lt;&lt;<span class="built_in">endl</span>;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;<span class="built_in">string</span>&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">cerr</span> &lt;&lt; *it &lt;&lt; <span class="string">" = "</span> &lt;&lt; a &lt;&lt; <span class="string">" , "</span>;</span><br><span class="line">	err(++it, args...);</span><br><span class="line">&#125;<span class="comment">// fast IO</span></span><br><span class="line"><span class="keyword">namespace</span> fastIO</span><br><span class="line">&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> BUF_SIZE 100000</span></span><br><span class="line"><span class="comment">//     fread -&gt; read</span></span><br><span class="line">    <span class="keyword">bool</span> IOerror = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">nc</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">char</span> buf[BUF_SIZE], *p1 = buf+BUF_SIZE,</span><br><span class="line">         *pend = buf+BUF_SIZE;</span><br><span class="line">         <span class="keyword">if</span>(p1==pend)&#123;</span><br><span class="line">             p1 = buf;</span><br><span class="line">             pend = buf+fread(buf, <span class="number">1</span>, BUF_SIZE, <span class="built_in">stdin</span>);</span><br><span class="line">             <span class="keyword">if</span>(pend==p1)&#123;</span><br><span class="line">                 IOerror = <span class="number">1</span>;</span><br><span class="line">                 <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> *p1++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">blank</span><span class="params">( <span class="keyword">char</span> ch )</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ch==<span class="string">' '</span>||ch==<span class="string">'\n'</span>||ch==<span class="string">'\r'</span>||ch==<span class="string">'\t'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch;</span><br><span class="line">        <span class="keyword">while</span>(blank(ch=nc()));</span><br><span class="line">        <span class="keyword">if</span>(IOerror)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">for</span>(x=ch-<span class="string">'0'</span>;(ch=nc())&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">undef</span> BUF_SIZE</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> fastIO;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="comment">///////// Macro ////////////////</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">4e6</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> p[maxn], tag[maxn], ans[maxn], isp[maxn];</span><br><span class="line"><span class="keyword">int</span> st[maxn], tot=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">ifdef</span> aoaoao</span></span><br><span class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">// aoaoao</span></span></span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;p[i]); isp[p[i]] = <span class="number">1</span>;&#125;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"1 -1"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    tag[<span class="number">0</span>]=INFI;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> t = p[i], cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(isp[i])<span class="keyword">continue</span>;</span><br><span class="line">        st[tot++] = t;</span><br><span class="line">        <span class="keyword">while</span>(tag[t]==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            tag[t] = cnt;</span><br><span class="line">            t = p[t];</span><br><span class="line">            st[tot++] = t;</span><br><span class="line">        &#125;</span><br><span class="line">        ans[i] = cnt + tag[t] + <span class="number">1</span>;</span><br><span class="line">        tag[t] = min(tag[t], cnt+<span class="number">1</span>);</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(tot)</span><br><span class="line">        &#123;</span><br><span class="line">            tag[st[tot<span class="number">-1</span>]] = min(tag[st[tot<span class="number">-1</span>]], tag[t] + cnt);</span><br><span class="line">            ++cnt;</span><br><span class="line">            --tot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(isp[i]) <span class="keyword">continue</span>;;</span><br><span class="line">        <span class="keyword">if</span>(ans[i]&gt;=INFI) &#123;<span class="built_in">printf</span>(<span class="string">"%d -1\n"</span>, i);<span class="keyword">continue</span>;&#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, i, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/25/JRY-s-Geo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/25/JRY-s-Geo/" itemprop="url">JRY's_Geo</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-25T15:54:30+08:00">
                2019-01-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>吉老师的计算几何板子</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line"><span class="keyword">const</span> db eps=<span class="number">1e-6</span>;</span><br><span class="line"><span class="keyword">const</span> db pi=<span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sign</span><span class="params">(db k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k&gt;eps) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">if</span> (k&lt;-eps) <span class="keyword">return</span> <span class="number">-1</span>; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(db k1,db k2)</span></span>&#123;<span class="keyword">return</span> sign(k1-k2);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inmid</span><span class="params">(db k1,db k2,db k3)</span></span>&#123;<span class="keyword">return</span> sign(k1-k3)*sign(k2-k3)&lt;=<span class="number">0</span>;&#125;<span class="comment">// k3 在 [k1,k2] 内 </span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span>&#123;</span></span><br><span class="line">    db x,y;</span><br><span class="line">    point <span class="keyword">operator</span> + (<span class="keyword">const</span> point &amp;k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;k1.x+x,k1.y+y&#125;;&#125;</span><br><span class="line">    point <span class="keyword">operator</span> - (<span class="keyword">const</span> point &amp;k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;x-k1.x,y-k1.y&#125;;&#125;</span><br><span class="line">    point <span class="keyword">operator</span> * (db k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;x*k1,y*k1&#125;;&#125;</span><br><span class="line">    point <span class="keyword">operator</span> / (db k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> (point)&#123;x/k1,y/k1&#125;;&#125;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> point &amp;k1) <span class="keyword">const</span>&#123;<span class="keyword">return</span> cmp(x,k1.x)==<span class="number">0</span>&amp;&amp;cmp(y,k1.y)==<span class="number">0</span>;&#125;</span><br><span class="line">    <span class="comment">// 逆时针旋转 </span></span><br><span class="line">    <span class="function">point <span class="title">turn</span><span class="params">(db k1)</span></span>&#123;<span class="keyword">return</span> (point)&#123;x*<span class="built_in">cos</span>(k1)-y*<span class="built_in">sin</span>(k1),x*<span class="built_in">sin</span>(k1)+y*<span class="built_in">cos</span>(k1)&#125;;&#125;</span><br><span class="line">    <span class="function">point <span class="title">turn90</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> (point)&#123;-y,x&#125;;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> point k1) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">int</span> a=cmp(x,k1.x);</span><br><span class="line">        <span class="keyword">if</span> (a==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">if</span> (a==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="keyword">else</span> <span class="keyword">return</span> cmp(y,k1.y)==<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">db <span class="title">abs</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y);&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs2</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x*x+y*y;&#125;</span><br><span class="line">    <span class="function">db <span class="title">dis</span><span class="params">(point k1)</span></span>&#123;<span class="keyword">return</span> ((*<span class="keyword">this</span>)-k1).<span class="built_in">abs</span>();&#125;</span><br><span class="line">    <span class="function">point <span class="title">unit</span><span class="params">()</span></span>&#123;db w=<span class="built_in">abs</span>(); <span class="keyword">return</span> (point)&#123;x/w,y/w&#125;;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span></span>&#123;<span class="keyword">double</span> k1,k2; <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>,&amp;k1,&amp;k2); x=k1; y=k2;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;<span class="built_in">printf</span>(<span class="string">"%.11lf %.11lf\n"</span>,x,y);&#125;</span><br><span class="line">    <span class="function">db <span class="title">getw</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">atan2</span>(y,x);&#125; </span><br><span class="line">    <span class="function">point <span class="title">getdel</span><span class="params">()</span></span>&#123;<span class="keyword">if</span> (sign(x)==<span class="number">-1</span>||(sign(x)==<span class="number">0</span>&amp;&amp;sign(y)==<span class="number">-1</span>)) <span class="keyword">return</span> (*<span class="keyword">this</span>)*(<span class="number">-1</span>); <span class="keyword">else</span> <span class="keyword">return</span> (*<span class="keyword">this</span>);&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getP</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;<span class="keyword">return</span> sign(y)==<span class="number">1</span>||(sign(y)==<span class="number">0</span>&amp;&amp;sign(x)==<span class="number">-1</span>);&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inmid</span><span class="params">(point k1,point k2,point k3)</span></span>&#123;<span class="keyword">return</span> inmid(k1.x,k2.x,k3.x)&amp;&amp;inmid(k1.y,k2.y,k3.y);&#125;</span><br><span class="line"><span class="function">db <span class="title">cross</span><span class="params">(point k1,point k2)</span></span>&#123;<span class="keyword">return</span> k1.x*k2.y-k1.y*k2.x;&#125;</span><br><span class="line"><span class="function">db <span class="title">dot</span><span class="params">(point k1,point k2)</span></span>&#123;<span class="keyword">return</span> k1.x*k2.x+k1.y*k2.y;&#125;</span><br><span class="line"><span class="function">db <span class="title">rad</span><span class="params">(point k1,point k2)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">atan2</span>(cross(k1,k2),dot(k1,k2));&#125;</span><br><span class="line"><span class="comment">// -pi -&gt; pi</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">compareangle</span> <span class="params">(point k1,point k2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> k1.getP()&lt;k2.getP()||(k1.getP()==k2.getP()&amp;&amp;sign(cross(k1,k2))&gt;<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">point <span class="title">proj</span><span class="params">(point k1,point k2,point q)</span></span>&#123; <span class="comment">// q 到直线 k1,k2 的投影 </span></span><br><span class="line">    point k=k2-k1; <span class="keyword">return</span> k1+k*(dot(q-k1,k)/k.abs2());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">point <span class="title">reflect</span><span class="params">(point k1,point k2,point q)</span></span>&#123;<span class="keyword">return</span> proj(k1,k2,q)*<span class="number">2</span>-q;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">clockwise</span><span class="params">(point k1,point k2,point k3)</span></span>&#123;<span class="comment">// k1 k2 k3 逆时针 1 顺时针 -1 否则 0  </span></span><br><span class="line">    <span class="keyword">return</span> sign(cross(k2-k1,k3-k1));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkLL</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;<span class="comment">// 求直线 (L) 线段 (S)k1,k2 和 k3,k4 的交点 </span></span><br><span class="line">    <span class="keyword">return</span> cmp(cross(k3-k1,k4-k1),cross(k3-k2,k4-k2))!=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">point <span class="title">getLL</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;</span><br><span class="line">    db w1=cross(k1-k3,k4-k3),w2=cross(k4-k3,k2-k3); <span class="keyword">return</span> (k1*w2+k2*w1)/(w1+w2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">intersect</span><span class="params">(db l1,db r1,db l2,db r2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l1&gt;r1) swap(l1,r1); <span class="keyword">if</span> (l2&gt;r2) swap(l2,r2); <span class="keyword">return</span> cmp(r1,l2)!=<span class="number">-1</span>&amp;&amp;cmp(r2,l1)!=<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkSS</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> intersect(k1.x,k2.x,k3.x,k4.x)&amp;&amp;intersect(k1.y,k2.y,k3.y,k4.y)&amp;&amp;</span><br><span class="line">    sign(cross(k3-k1,k4-k1))*sign(cross(k3-k2,k4-k2))&lt;=<span class="number">0</span>&amp;&amp;</span><br><span class="line">    sign(cross(k1-k3,k2-k3))*sign(cross(k1-k4,k2-k4))&lt;=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disSP</span><span class="params">(point k1,point k2,point q)</span></span>&#123;</span><br><span class="line">    point k3=proj(k1,k2,q);</span><br><span class="line">    <span class="keyword">if</span> (inmid(k1,k2,k3)) <span class="keyword">return</span> q.dis(k3); <span class="keyword">else</span> <span class="keyword">return</span> min(q.dis(k1),q.dis(k2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disSS</span><span class="params">(point k1,point k2,point k3,point k4)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (checkSS(k1,k2,k3,k4)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> min(min(disSP(k1,k2,k3),disSP(k1,k2,k4)),min(disSP(k3,k4,k1),disSP(k3,k4,k2)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">onS</span><span class="params">(point k1,point k2,point q)</span></span>&#123;<span class="keyword">return</span> inmid(k1,k2,q)&amp;&amp;sign(cross(k1-q,k2-k1))==<span class="number">0</span>;&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">circle</span>&#123;</span></span><br><span class="line">    point o; db r;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span></span>&#123;o.scan(); <span class="built_in">scanf</span>(<span class="string">"%lf"</span>,&amp;r);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">inside</span><span class="params">(point k)</span></span>&#123;<span class="keyword">return</span> cmp(r,o.dis(k));&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span>&#123;</span></span><br><span class="line">    <span class="comment">// p[0]-&gt;p[1]</span></span><br><span class="line">    point p[<span class="number">2</span>];</span><br><span class="line">    line(point k1,point k2)&#123;p[<span class="number">0</span>]=k1; p[<span class="number">1</span>]=k2;&#125;</span><br><span class="line">    point&amp; <span class="keyword">operator</span> [] (<span class="keyword">int</span> k)&#123;<span class="keyword">return</span> p[k];&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">include</span><span class="params">(point k)</span></span>&#123;<span class="keyword">return</span> sign(cross(p[<span class="number">1</span>]-p[<span class="number">0</span>],k-p[<span class="number">0</span>]))&gt;<span class="number">0</span>;&#125;</span><br><span class="line">    <span class="function">point <span class="title">dir</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> p[<span class="number">1</span>]-p[<span class="number">0</span>];&#125;</span><br><span class="line">    <span class="function">line <span class="title">push</span><span class="params">()</span></span>&#123; <span class="comment">// 向外 ( 左手边 ) 平移 eps </span></span><br><span class="line">        <span class="keyword">const</span> db eps = <span class="number">1e-6</span>;</span><br><span class="line">        point delta=(p[<span class="number">1</span>]-p[<span class="number">0</span>]).turn90().unit()*eps;</span><br><span class="line">        <span class="keyword">return</span> &#123;p[<span class="number">0</span>]-delta,p[<span class="number">1</span>]-delta&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">point <span class="title">getLL</span><span class="params">(line k1,line k2)</span></span>&#123;<span class="keyword">return</span> getLL(k1[<span class="number">0</span>],k1[<span class="number">1</span>],k2[<span class="number">0</span>],k2[<span class="number">1</span>]);&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">parallel</span><span class="params">(line k1,line k2)</span></span>&#123;<span class="keyword">return</span> sign(cross(k1.dir(),k2.dir()))==<span class="number">0</span>;&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sameDir</span><span class="params">(line k1,line k2)</span></span>&#123;<span class="keyword">return</span> parallel(k1,k2)&amp;&amp;sign(dot(k1.dir(),k2.dir()))==<span class="number">1</span>;&#125;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">operator</span> &lt; (line k1,line k2)&#123;</span><br><span class="line">    <span class="keyword">if</span> (sameDir(k1,k2)) <span class="keyword">return</span> k2.include(k1[<span class="number">0</span>]); </span><br><span class="line">    <span class="keyword">return</span> compareangle(k1.dir(),k2.dir());</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkpos</span><span class="params">(line k1,line k2,line k3)</span></span>&#123;<span class="keyword">return</span> k3.include(getLL(k1,k2));&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; getHL(<span class="built_in">vector</span>&lt;line&gt; &amp;L)&#123; <span class="comment">// 求半平面交 , 半平面是逆时针方向 , 输出按照逆时针</span></span><br><span class="line">    sort(L.begin(),L.end()); <span class="built_in">deque</span>&lt;line&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;(<span class="keyword">int</span>)L.size();i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (i&amp;&amp;sameDir(L[i],L[i<span class="number">-1</span>])) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">while</span> (q.size()&gt;<span class="number">1</span>&amp;&amp;!checkpos(q[q.size()<span class="number">-2</span>],q[q.size()<span class="number">-1</span>],L[i])) q.pop_back();</span><br><span class="line">        <span class="keyword">while</span> (q.size()&gt;<span class="number">1</span>&amp;&amp;!checkpos(q[<span class="number">1</span>],q[<span class="number">0</span>],L[i])) q.pop_front();</span><br><span class="line">        q.push_back(L[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q.size()&gt;<span class="number">2</span>&amp;&amp;!checkpos(q[q.size()<span class="number">-2</span>],q[q.size()<span class="number">-1</span>],q[<span class="number">0</span>])) q.pop_back();</span><br><span class="line">    <span class="keyword">while</span> (q.size()&gt;<span class="number">2</span>&amp;&amp;!checkpos(q[<span class="number">1</span>],q[<span class="number">0</span>],q[q.size()<span class="number">-1</span>])) q.pop_front();</span><br><span class="line">    <span class="built_in">vector</span>&lt;line&gt;ans; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;q.size();i++) ans.push_back(q[i]);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">closepoint</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;&amp;A,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123; <span class="comment">// 最近点对 , 先要按照 x 坐标排序 </span></span><br><span class="line">    <span class="keyword">if</span> (r-l&lt;=<span class="number">5</span>)&#123;</span><br><span class="line">        db ans=<span class="number">1e20</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=l;i&lt;=r;i++) <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;=r;j++) ans=min(ans,A[i].dis(A[j]));</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; db ans=min(closepoint(A,l,mid),closepoint(A,mid+<span class="number">1</span>,r));</span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;B; <span class="keyword">for</span> (<span class="keyword">int</span> i=l;i&lt;=r;i++) <span class="keyword">if</span> (<span class="built_in">abs</span>(A[i].x-A[mid].x)&lt;=ans) B.push_back(A[i]);</span><br><span class="line">    sort(B.begin(),B.end(),[](point k1,point k2)&#123;<span class="keyword">return</span> k1.y&lt;k2.y;&#125;);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;B.size();i++) <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;B.size()&amp;&amp;B[j].y-B[i].y&lt;ans;j++) ans=min(ans,B[i].dis(B[j]));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkposCC</span><span class="params">(circle k1,circle k2)</span></span>&#123;<span class="comment">// 返回两个圆的公切线数量</span></span><br><span class="line">    <span class="keyword">if</span> (cmp(k1.r,k2.r)==<span class="number">-1</span>) swap(k1,k2);</span><br><span class="line">    db dis=k1.o.dis(k2.o);  <span class="keyword">int</span> w1=cmp(dis,k1.r+k2.r),w2=cmp(dis,k1.r-k2.r);</span><br><span class="line">    <span class="keyword">if</span> (w1&gt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">4</span>; <span class="keyword">else</span> <span class="keyword">if</span> (w1==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">3</span>; <span class="keyword">else</span> <span class="keyword">if</span> (w2&gt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">2</span>; </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (w2==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; getCL(circle k1,point k2,point k3)&#123; <span class="comment">// 沿着 k2-&gt;k3 方向给出 , 相切给出两个 </span></span><br><span class="line">    point k=proj(k2,k3,k1.o); db d=k1.r*k1.r-(k-k1.o).abs2();</span><br><span class="line">    <span class="keyword">if</span> (sign(d)==<span class="number">-1</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    point del=(k3-k2).unit()*<span class="built_in">sqrt</span>(max((db)<span class="number">0.0</span>,d)); <span class="keyword">return</span> &#123;k-del,k+del&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; getCC(circle k1,circle k2)&#123;<span class="comment">// 沿圆 k1 逆时针给出 , 相切给出两个 </span></span><br><span class="line">    <span class="keyword">int</span> pd=checkposCC(k1,k2); <span class="keyword">if</span> (pd==<span class="number">0</span>||pd==<span class="number">4</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    db a=(k2.o-k1.o).abs2(),cosA=(k1.r*k1.r+a-k2.r*k2.r)/(<span class="number">2</span>*k1.r*<span class="built_in">sqrt</span>(max(a,(db)<span class="number">0.0</span>)));</span><br><span class="line">    db b=k1.r*cosA,c=<span class="built_in">sqrt</span>(max((db)<span class="number">0.0</span>,k1.r*k1.r-b*b));</span><br><span class="line">    point k=(k2.o-k1.o).unit(),m=k1.o+k*b,del=k.turn90()*c;</span><br><span class="line">    <span class="keyword">return</span> &#123;m-del,m+del&#125;;</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; TangentCP(circle k1,point k2)&#123;<span class="comment">// 沿圆 k1 逆时针给出 </span></span><br><span class="line">    db a=(k2-k1.o).<span class="built_in">abs</span>(),b=k1.r*k1.r/a,c=<span class="built_in">sqrt</span>(max((db)<span class="number">0.0</span>,k1.r*k1.r-b*b));</span><br><span class="line">    point k=(k2-k1.o).unit(),m=k1.o+k*b,del=k.turn90()*c;</span><br><span class="line">    <span class="keyword">return</span> &#123;m-del,m+del&#125;;</span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; TangentoutCC(circle k1,circle k2)&#123;</span><br><span class="line">    <span class="keyword">int</span> pd=checkposCC(k1,k2); <span class="keyword">if</span> (pd==<span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;; </span><br><span class="line">    <span class="keyword">if</span> (pd==<span class="number">1</span>)&#123;point k=getCC(k1,k2)[<span class="number">0</span>]; <span class="keyword">return</span> &#123;(line)&#123;k,k&#125;&#125;;&#125;</span><br><span class="line">    <span class="keyword">if</span> (cmp(k1.r,k2.r)==<span class="number">0</span>)&#123;</span><br><span class="line">        point del=(k2.o-k1.o).unit().turn90().getdel();</span><br><span class="line">        <span class="keyword">return</span> &#123;(line)&#123;k1.o-del*k1.r,k2.o-del*k2.r&#125;,(line)&#123;k1.o+del*k1.r,k2.o+del*k2.r&#125;&#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        point p=(k2.o*k1.r-k1.o*k2.r)/(k1.r-k2.r);</span><br><span class="line">        <span class="built_in">vector</span>&lt;point&gt;A=TangentCP(k1,p),B=TangentCP(k2,p);</span><br><span class="line">        <span class="built_in">vector</span>&lt;line&gt;ans; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) ans.push_back((line)&#123;A[i],B[i]&#125;); </span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; TangentinCC(circle k1,circle k2)&#123;</span><br><span class="line">    <span class="keyword">int</span> pd=checkposCC(k1,k2); <span class="keyword">if</span> (pd&lt;=<span class="number">2</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">if</span> (pd==<span class="number">3</span>)&#123;point k=getCC(k1,k2)[<span class="number">0</span>]; <span class="keyword">return</span> &#123;(line)&#123;k,k&#125;&#125;;&#125; </span><br><span class="line">    point p=(k2.o*k1.r+k1.o*k2.r)/(k1.r+k2.r);</span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;A=TangentCP(k1,p),B=TangentCP(k2,p);</span><br><span class="line">    <span class="built_in">vector</span>&lt;line&gt;ans; <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) ans.push_back((line)&#123;A[i],B[i]&#125;); </span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;line&gt; TangentCC(circle k1,circle k2)&#123;</span><br><span class="line">    <span class="keyword">int</span> flag=<span class="number">0</span>; <span class="keyword">if</span> (k1.r&lt;k2.r) swap(k1,k2),flag=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;line&gt;A=TangentoutCC(k1,k2),B=TangentinCC(k1,k2);</span><br><span class="line">    <span class="keyword">for</span> (line k:B) A.push_back(k); </span><br><span class="line">    <span class="keyword">if</span> (flag) <span class="keyword">for</span> (line &amp;k:A) swap(k[<span class="number">0</span>],k[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">getarea</span><span class="params">(circle k1,point k2,point k3)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 圆 k1 与三角形 k2 k3 k1.o 的有向面积交</span></span><br><span class="line">    point k=k1.o; k1.o=k1.o-k; k2=k2-k; k3=k3-k;</span><br><span class="line">    <span class="keyword">int</span> pd1=k1.inside(k2),pd2=k1.inside(k3); </span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;A=getCL(k1,k2,k3);</span><br><span class="line">    <span class="keyword">if</span> (pd1&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (pd2&gt;=<span class="number">0</span>) <span class="keyword">return</span> cross(k2,k3)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> k1.r*k1.r*rad(A[<span class="number">1</span>],k3)/<span class="number">2</span>+cross(k2,A[<span class="number">1</span>])/<span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pd2&gt;=<span class="number">0</span>)&#123; </span><br><span class="line">        <span class="keyword">return</span> k1.r*k1.r*rad(k2,A[<span class="number">0</span>])/<span class="number">2</span>+cross(A[<span class="number">0</span>],k3)/<span class="number">2</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> pd=cmp(k1.r,disSP(k2,k3,k1.o));</span><br><span class="line">        <span class="keyword">if</span> (pd&lt;=<span class="number">0</span>) <span class="keyword">return</span> k1.r*k1.r*rad(k2,k3)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span> cross(A[<span class="number">0</span>],A[<span class="number">1</span>])/<span class="number">2</span>+k1.r*k1.r*(rad(k2,A[<span class="number">0</span>])+rad(A[<span class="number">1</span>],k3))/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">circle <span class="title">getcircle</span><span class="params">(point k1,point k2,point k3)</span></span>&#123;</span><br><span class="line">    db a1=k2.x-k1.x,b1=k2.y-k1.y,c1=(a1*a1+b1*b1)/<span class="number">2</span>;</span><br><span class="line">    db a2=k3.x-k1.x,b2=k3.y-k1.y,c2=(a2*a2+b2*b2)/<span class="number">2</span>;</span><br><span class="line">    db d=a1*b2-a2*b1;</span><br><span class="line">    point o=(point)&#123;k1.x+(c1*b2-c2*b1)/d,k1.y+(a1*c2-a2*c1)/d&#125;;</span><br><span class="line">    <span class="keyword">return</span> (circle)&#123;o,k1.dis(o)&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">circle <span class="title">getScircle</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt; A)</span></span>&#123;</span><br><span class="line">    random_shuffle(A.begin(),A.end());</span><br><span class="line">    circle ans=(circle)&#123;A[<span class="number">0</span>],<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.size();i++)</span><br><span class="line">        <span class="keyword">if</span> (ans.inside(A[i])==<span class="number">-1</span>)&#123;</span><br><span class="line">            ans=(circle)&#123;A[i],<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)</span><br><span class="line">                <span class="keyword">if</span> (ans.inside(A[j])==<span class="number">-1</span>)&#123;</span><br><span class="line">                    ans.o=(A[i]+A[j])/<span class="number">2</span>; ans.r=ans.o.dis(A[i]);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;j;k++)</span><br><span class="line">                        <span class="keyword">if</span> (ans.inside(A[k])==<span class="number">-1</span>)</span><br><span class="line">                            ans=getcircle(A[i],A[j],A[k]);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">area</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt; A)</span></span>&#123; <span class="comment">// 多边形用 vector&lt;point&gt; 表示 , 逆时针 </span></span><br><span class="line">    db ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) ans+=cross(A[i],A[(i+<span class="number">1</span>)%A.size()]);</span><br><span class="line">    <span class="keyword">return</span> ans/<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkconvex</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n=A.size(); A.push_back(A[<span class="number">0</span>]); A.push_back(A[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) <span class="keyword">if</span> (sign(cross(A[i+<span class="number">1</span>]-A[i],A[i+<span class="number">2</span>]-A[i]))==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">contain</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,point q)</span></span>&#123; <span class="comment">// 2 内部 1 边界 0 外部</span></span><br><span class="line">    <span class="keyword">int</span> pd=<span class="number">0</span>; A.push_back(A[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.size();i++)&#123;</span><br><span class="line">        point u=A[i<span class="number">-1</span>],v=A[i];</span><br><span class="line">        <span class="keyword">if</span> (onS(u,v,q)) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">if</span> (cmp(u.y,v.y)&gt;<span class="number">0</span>) swap(u,v);</span><br><span class="line">        <span class="keyword">if</span> (cmp(u.y,q.y)&gt;=<span class="number">0</span>||cmp(v.y,q.y)&lt;<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (sign(cross(u-v,q-v))&lt;<span class="number">0</span>) pd^=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pd&lt;&lt;<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; ConvexHull(<span class="built_in">vector</span>&lt;point&gt;A,<span class="keyword">int</span> flag=<span class="number">1</span>)&#123; <span class="comment">// flag=0 不严格 flag=1 严格 </span></span><br><span class="line">    <span class="keyword">int</span> n=A.size(); <span class="built_in">vector</span>&lt;point&gt;ans(n*<span class="number">2</span>); </span><br><span class="line">    sort(A.begin(),A.end()); <span class="keyword">int</span> now=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++)&#123;</span><br><span class="line">        <span class="keyword">while</span> (now&gt;<span class="number">0</span>&amp;&amp;sign(cross(ans[now]-ans[now<span class="number">-1</span>],A[i]-ans[now<span class="number">-1</span>]))&lt;flag) now--;</span><br><span class="line">        ans[++now]=A[i];</span><br><span class="line">    &#125; <span class="keyword">int</span> pre=now;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=n<span class="number">-2</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">while</span> (now&gt;pre&amp;&amp;sign(cross(ans[now]-ans[now<span class="number">-1</span>],A[i]-ans[now<span class="number">-1</span>]))&lt;flag) now--;</span><br><span class="line">        ans[++now]=A[i];</span><br><span class="line">    &#125; ans.resize(now); <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">convexDiameter</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> now=<span class="number">0</span>,n=A.size(); db ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++)&#123;</span><br><span class="line">        now=max(now,i);</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)&#123;</span><br><span class="line">            db k1=A[i].dis(A[now%n]),k2=A[i].dis(A[(now+<span class="number">1</span>)%n]);</span><br><span class="line">            ans=max(ans,max(k1,k2)); <span class="keyword">if</span> (k2&gt;k1) now++; <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;point&gt; convexcut(<span class="built_in">vector</span>&lt;point&gt;A,point k1,point k2)&#123;</span><br><span class="line">    <span class="comment">// 保留 k1,k2,p 逆时针的所有点</span></span><br><span class="line">    <span class="keyword">int</span> n=A.size(); A.push_back(A[<span class="number">0</span>]); <span class="built_in">vector</span>&lt;point&gt;ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> w1=clockwise(k1,k2,A[i]),w2=clockwise(k1,k2,A[i+<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (w1&gt;=<span class="number">0</span>) ans.push_back(A[i]);</span><br><span class="line">        <span class="keyword">if</span> (w1*w2&lt;<span class="number">0</span>) ans.push_back(getLL(k1,k2,A[i],A[i+<span class="number">1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkPoS</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,point k1,point k2)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 多边形 A 和直线 ( 线段 )k1-&gt;k2 严格相交 , 注释部分为线段</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ins</span>&#123;</span></span><br><span class="line">        point m,u,v;</span><br><span class="line">        <span class="keyword">int</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> ins&amp; k) <span class="keyword">const</span> &#123;<span class="keyword">return</span> m&lt;k.m;&#125;</span><br><span class="line">    &#125;; <span class="built_in">vector</span>&lt;ins&gt;B;</span><br><span class="line">    <span class="comment">//if (contain(A,k1)==2||contain(A,k2)==2) return 1;</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;poly=A; A.push_back(A[<span class="number">0</span>]); </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;A.size();i++) <span class="keyword">if</span> (checkLL(A[i<span class="number">-1</span>],A[i],k1,k2))&#123;</span><br><span class="line">        point m=getLL(A[i<span class="number">-1</span>],A[i],k1,k2); </span><br><span class="line">        <span class="keyword">if</span> (inmid(A[i<span class="number">-1</span>],A[i],m)<span class="comment">/*&amp;&amp;inmid(k1,k2,m)*/</span>) B.push_back((ins)&#123;m,A[i<span class="number">-1</span>],A[i]&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (B.size()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; sort(B.begin(),B.end()); </span><br><span class="line">    <span class="keyword">int</span> now=<span class="number">1</span>; <span class="keyword">while</span> (now&lt;B.size()&amp;&amp;B[now].m==B[<span class="number">0</span>].m) now++; </span><br><span class="line">    <span class="keyword">if</span> (now==B.size()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flag=contain(poly,(B[<span class="number">0</span>].m+B[now].m)/<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (flag==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    point d=B[now].m-B[<span class="number">0</span>].m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=now;i&lt;B.size();i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (!(B[i].m==B[i<span class="number">-1</span>].m)&amp;&amp;flag==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> tag=sign(cross(B[i].v-B[i].u,B[i].m+d-B[i].u));</span><br><span class="line">        <span class="keyword">if</span> (B[i].m==B[i].u||B[i].m==B[i].v) flag+=tag; <span class="keyword">else</span> flag+=tag*<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//return 0;</span></span><br><span class="line">    <span class="keyword">return</span> flag==<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkinp</span><span class="params">(point r,point l,point m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (compareangle(l,r))&#123;<span class="keyword">return</span> compareangle(l,m)&amp;&amp;compareangle(m,r);&#125;</span><br><span class="line">	<span class="keyword">return</span> compareangle(l,m)||compareangle(m,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">checkPosFast</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,point k1,point k2)</span></span>&#123; <span class="comment">// 快速检查线段是否和多边形严格相交</span></span><br><span class="line">	<span class="keyword">if</span> (contain(A,k1)==<span class="number">2</span>||contain(A,k2)==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">if</span> (k1==k2) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	A.push_back(A[<span class="number">0</span>]); A.push_back(A[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i+<span class="number">1</span>&lt;A.size();i++)</span><br><span class="line">		<span class="keyword">if</span> (checkLL(A[i<span class="number">-1</span>],A[i],k1,k2))&#123;</span><br><span class="line">			point now=getLL(A[i<span class="number">-1</span>],A[i],k1,k2);</span><br><span class="line">			<span class="keyword">if</span> (inmid(A[i<span class="number">-1</span>],A[i],now)==<span class="number">0</span>||inmid(k1,k2,now)==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span> (now==A[i])&#123;</span><br><span class="line">				<span class="keyword">if</span> (A[i]==k2) <span class="keyword">continue</span>;</span><br><span class="line">				point pre=A[i<span class="number">-1</span>],ne=A[i+<span class="number">1</span>];</span><br><span class="line">				<span class="keyword">if</span> (checkinp(pre-now,ne-now,k2-now)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (now==k1)&#123;</span><br><span class="line">				<span class="keyword">if</span> (k1==A[i<span class="number">-1</span>]||k1==A[i]) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">if</span> (checkinp(A[i<span class="number">-1</span>]-k1,A[i]-k1,k2-k1)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (now==k2||now==A[i<span class="number">-1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 拆分凸包成上下凸壳 凸包尽量都随机旋转一个角度来避免出现相同横坐标 </span></span><br><span class="line"><span class="comment">// 尽量特判只有一个点的情况 凸包逆时针</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getUDP</span><span class="params">(<span class="built_in">vector</span>&lt;point&gt;A,<span class="built_in">vector</span>&lt;point&gt;&amp;U,<span class="built_in">vector</span>&lt;point&gt;&amp;D)</span></span>&#123;</span><br><span class="line">    db l=<span class="number">1e100</span>,r=<span class="number">-1e100</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) l=min(l,A[i].x),r=max(r,A[i].x);</span><br><span class="line">    <span class="keyword">int</span> wherel,wherer;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) <span class="keyword">if</span> (cmp(A[i].x,l)==<span class="number">0</span>) wherel=i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=A.size();i;i--) <span class="keyword">if</span> (cmp(A[i<span class="number">-1</span>].x,r)==<span class="number">0</span>) wherer=i<span class="number">-1</span>;</span><br><span class="line">    U.clear(); D.clear(); <span class="keyword">int</span> now=wherel;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;D.push_back(A[now]); <span class="keyword">if</span> (now==wherer) <span class="keyword">break</span>; now++; <span class="keyword">if</span> (now&gt;=A.size()) now=<span class="number">0</span>;&#125;</span><br><span class="line">    now=wherel;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)&#123;U.push_back(A[now]); <span class="keyword">if</span> (now==wherer) <span class="keyword">break</span>; now--; <span class="keyword">if</span> (now&lt;<span class="number">0</span>) now=A.size()<span class="number">-1</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 需要保证凸包点数大于等于 3,2 内部 ,1 边界 ,0 外部</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">containCoP</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;U,<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;D,point k)</span></span>&#123;</span><br><span class="line">    db lx=U[<span class="number">0</span>].x,rx=U[U.size()<span class="number">-1</span>].x;</span><br><span class="line">    <span class="keyword">if</span> (k==U[<span class="number">0</span>]||k==U[U.size()<span class="number">-1</span>]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (cmp(k.x,lx)==<span class="number">-1</span>||cmp(k.x,rx)==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> where1=lower_bound(U.begin(),U.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-U.begin();</span><br><span class="line">    <span class="keyword">int</span> where2=lower_bound(D.begin(),D.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-D.begin();</span><br><span class="line">    <span class="keyword">int</span> w1=clockwise(U[where1<span class="number">-1</span>],U[where1],k),w2=clockwise(D[where2<span class="number">-1</span>],D[where2],k);</span><br><span class="line">    <span class="keyword">if</span> (w1==<span class="number">1</span>||w2==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="keyword">else</span> <span class="keyword">if</span> (w1==<span class="number">0</span>||w2==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// d 是方向 , 输出上方切点和下方切点</span></span><br><span class="line">pair&lt;point,point&gt; getTangentCow(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt; &amp;U,<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt; &amp;D,point d)&#123;</span><br><span class="line">    <span class="keyword">if</span> (sign(d.x)&lt;<span class="number">0</span>||(sign(d.x)==<span class="number">0</span>&amp;&amp;sign(d.y)&lt;<span class="number">0</span>)) d=d*(<span class="number">-1</span>);</span><br><span class="line">    point whereU,whereD;</span><br><span class="line">    <span class="keyword">if</span> (sign(d.x)==<span class="number">0</span>) <span class="keyword">return</span> mp(U[<span class="number">0</span>],U[U.size()<span class="number">-1</span>]);</span><br><span class="line">    <span class="keyword">int</span> l=<span class="number">0</span>,r=U.size()<span class="number">-1</span>,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (sign(cross(U[mid+<span class="number">1</span>]-U[mid],d))&lt;=<span class="number">0</span>) l=mid+<span class="number">1</span>,ans=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">    whereU=U[ans]; l=<span class="number">0</span>,r=D.size()<span class="number">-1</span>,ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (sign(cross(D[mid+<span class="number">1</span>]-D[mid],d))&gt;=<span class="number">0</span>) l=mid+<span class="number">1</span>,ans=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">    whereD=D[ans]; <span class="keyword">return</span> mp(whereU,whereD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 先检查 contain, 逆时针给出</span></span><br><span class="line">pair&lt;point,point&gt; getTangentCoP(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;U,<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt;&amp;D,point k)&#123;</span><br><span class="line">    db lx=U[<span class="number">0</span>].x,rx=U[U.size()<span class="number">-1</span>].x;</span><br><span class="line">    <span class="keyword">if</span> (k.x&lt;lx)&#123;</span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">0</span>,r=U.size()<span class="number">-1</span>,ans=U.size()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid+<span class="number">1</span>])==<span class="number">1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">        point w1=U[ans]; l=<span class="number">0</span>,r=D.size()<span class="number">-1</span>,ans=D.size()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid+<span class="number">1</span>])==<span class="number">-1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">        point w2=D[ans]; <span class="keyword">return</span> mp(w1,w2);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k.x&gt;rx)&#123;</span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">1</span>,r=U.size(),ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid<span class="number">-1</span>])==<span class="number">-1</span>) r=mid; <span class="keyword">else</span> ans=mid,l=mid+<span class="number">1</span>;&#125;</span><br><span class="line">        point w1=U[ans]; l=<span class="number">1</span>,r=D.size(),ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid<span class="number">-1</span>])==<span class="number">1</span>) r=mid; <span class="keyword">else</span> ans=mid,l=mid+<span class="number">1</span>;&#125;</span><br><span class="line">        point w2=D[ans]; <span class="keyword">return</span> mp(w2,w1);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> where1=lower_bound(U.begin(),U.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-U.begin();</span><br><span class="line">        <span class="keyword">int</span> where2=lower_bound(D.begin(),D.end(),(point)&#123;k.x,<span class="number">-1e100</span>&#125;)-D.begin();</span><br><span class="line">        <span class="keyword">if</span> ((k.x==lx&amp;&amp;k.y&gt;U[<span class="number">0</span>].y)||(where1&amp;&amp;clockwise(U[where1<span class="number">-1</span>],U[where1],k)==<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">int</span> l=<span class="number">1</span>,r=where1+<span class="number">1</span>,ans=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid<span class="number">-1</span>])==<span class="number">1</span>) ans=mid,l=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">            point w1=U[ans]; l=where1,r=U.size()<span class="number">-1</span>,ans=U.size()<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,U[mid],U[mid+<span class="number">1</span>])==<span class="number">1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">            point w2=U[ans]; <span class="keyword">return</span> mp(w2,w1);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> l=<span class="number">1</span>,r=where2+<span class="number">1</span>,ans=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid<span class="number">-1</span>])==<span class="number">-1</span>) ans=mid,l=mid+<span class="number">1</span>; <span class="keyword">else</span> r=mid;&#125;</span><br><span class="line">            point w1=D[ans]; l=where2,r=D.size()<span class="number">-1</span>,ans=D.size()<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span> (l&lt;r)&#123;<span class="keyword">int</span> mid=l+r&gt;&gt;<span class="number">1</span>; <span class="keyword">if</span> (clockwise(k,D[mid],D[mid+<span class="number">1</span>])==<span class="number">-1</span>) l=mid+<span class="number">1</span>; <span class="keyword">else</span> ans=mid,r=mid;&#125;</span><br><span class="line">            point w2=D[ans]; <span class="keyword">return</span> mp(w1,w2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">P3</span>&#123;</span></span><br><span class="line">    db x,y,z;</span><br><span class="line">    P3 <span class="keyword">operator</span> + (P3 k1)&#123;<span class="keyword">return</span> (P3)&#123;x+k1.x,y+k1.y,z+k1.z&#125;;&#125;</span><br><span class="line">    P3 <span class="keyword">operator</span> - (P3 k1)&#123;<span class="keyword">return</span> (P3)&#123;x-k1.x,y-k1.y,z-k1.z&#125;;&#125;</span><br><span class="line">    P3 <span class="keyword">operator</span> * (db k1)&#123;<span class="keyword">return</span> (P3)&#123;x*k1,y*k1,z*k1&#125;;&#125;</span><br><span class="line">    P3 <span class="keyword">operator</span> / (db k1)&#123;<span class="keyword">return</span> (P3)&#123;x/k1,y/k1,z/k1&#125;;&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs2</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> x*x+y*y+z*z;&#125;</span><br><span class="line">    <span class="function">db <span class="title">abs</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x+y*y+z*z);&#125;</span><br><span class="line">    <span class="function">P3 <span class="title">unit</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> (*<span class="keyword">this</span>)/<span class="built_in">abs</span>();&#125;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> P3 k1) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cmp(x,k1.x)!=<span class="number">0</span>) <span class="keyword">return</span> x&lt;k1.x;</span><br><span class="line">        <span class="keyword">if</span> (cmp(y,k1.y)!=<span class="number">0</span>) <span class="keyword">return</span> y&lt;k1.y;</span><br><span class="line">        <span class="keyword">return</span> cmp(z,k1.z)==<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> P3 k1)&#123;</span><br><span class="line">        <span class="keyword">return</span> cmp(x,k1.x)==<span class="number">0</span>&amp;&amp;cmp(y,k1.y)==<span class="number">0</span>&amp;&amp;cmp(z,k1.z)==<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> k1,k2,k3; <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>,&amp;k1,&amp;k2,&amp;k3);</span><br><span class="line">        x=k1; y=k2; z=k3;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">P3 <span class="title">cross</span><span class="params">(P3 k1,P3 k2)</span></span>&#123;<span class="keyword">return</span> (P3)&#123;k1.y*k2.z-k1.z*k2.y,k1.z*k2.x-k1.x*k2.z,k1.x*k2.y-k1.y*k2.x&#125;;&#125;</span><br><span class="line"><span class="function">db <span class="title">dot</span><span class="params">(P3 k1,P3 k2)</span></span>&#123;<span class="keyword">return</span> k1.x*k2.x+k1.y*k2.y+k1.z*k2.z;&#125;</span><br><span class="line"><span class="comment">//p=(3,4,5),l=(13,19,21),theta=85 ans=(2.83,4.62,1.77)</span></span><br><span class="line"><span class="function">P3 <span class="title">turn3D</span><span class="params">(db k1,P3 l,P3 p)</span></span>&#123;</span><br><span class="line">    l=l.unit(); P3 ans; db c=<span class="built_in">cos</span>(k1),s=<span class="built_in">sin</span>(k1);</span><br><span class="line">    ans.x=p.x*(l.x*l.x*(<span class="number">1</span>-c)+c)+p.y*(l.x*l.y*(<span class="number">1</span>-c)-l.z*s)+p.z*(l.x*l.z*(<span class="number">1</span>-c)+l.y*s);</span><br><span class="line">    ans.y=p.x*(l.x*l.y*(<span class="number">1</span>-c)+l.z*s)+p.y*(l.y*l.y*(<span class="number">1</span>-c)+c)+p.z*(l.y*l.z*(<span class="number">1</span>-c)-l.x*s);</span><br><span class="line">    ans.z=p.x*(l.x*l.z*(<span class="number">1</span>-c)-l.y*s)+p.y*(l.y*l.z*(<span class="number">1</span>-c)+l.x*s)+p.z*(l.x*l.x*(<span class="number">1</span>-c)+c);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;P3&gt; VP;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;VP&gt; VVP;</span><br><span class="line"><span class="function">db <span class="title">Acos</span><span class="params">(db x)</span></span>&#123;<span class="keyword">return</span> <span class="built_in">acos</span>(max(-(db)<span class="number">1</span>,min(x,(db)<span class="number">1</span>)));&#125;</span><br><span class="line"><span class="comment">// 球面距离 , 圆心原点 , 半径 1</span></span><br><span class="line"><span class="function">db <span class="title">Odist</span><span class="params">(P3 a,P3 b)</span></span>&#123;db r=Acos(dot(a,b)); <span class="keyword">return</span> r;&#125;</span><br><span class="line">db r; P3 rnd;</span><br><span class="line"><span class="built_in">vector</span>&lt;db&gt; solve(db a,db b,db c)&#123;</span><br><span class="line">    db r=<span class="built_in">sqrt</span>(a*a+b*b),th=<span class="built_in">atan2</span>(b,a);</span><br><span class="line">    <span class="keyword">if</span> (cmp(c,-r)==<span class="number">-1</span>) <span class="keyword">return</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cmp(r,c)&lt;=<span class="number">0</span>) <span class="keyword">return</span> &#123;<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        db tr=pi-Acos(c/r); <span class="keyword">return</span> &#123;th+pi-tr,th+pi+tr&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">vector</span>&lt;db&gt; jiao(P3 a,P3 b)&#123;</span><br><span class="line">    <span class="comment">// dot(rd+x*cos(t)+y*sin(t),b) &gt;= cos(r)</span></span><br><span class="line">    <span class="keyword">if</span> (cmp(Odist(a,b),<span class="number">2</span>*r)&gt;<span class="number">0</span>) <span class="keyword">return</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    P3 rd=a*<span class="built_in">cos</span>(r),z=a.unit(),y=cross(z,rnd).unit(),x=cross(y,z).unit();</span><br><span class="line">    <span class="built_in">vector</span>&lt;db&gt; ret = solve(-(dot(x,b)*<span class="built_in">sin</span>(r)),-(dot(y,b)*<span class="built_in">sin</span>(r)),-(<span class="built_in">cos</span>(r)-dot(rd,b))); </span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">norm</span><span class="params">(db x,db l=<span class="number">0</span>,db r=<span class="number">2</span>*pi)</span></span>&#123; <span class="comment">// change x into [l,r)</span></span><br><span class="line">    <span class="keyword">while</span> (cmp(x,l)==<span class="number">-1</span>) x+=(r-l); <span class="keyword">while</span> (cmp(x,r)&gt;=<span class="number">0</span>) x-=(r-l);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disLP</span><span class="params">(P3 k1,P3 k2,P3 q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (cross(k2-k1,q-k1)).<span class="built_in">abs</span>()/(k2-k1).<span class="built_in">abs</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">disLL</span><span class="params">(P3 k1,P3 k2,P3 k3,P3 k4)</span></span>&#123;</span><br><span class="line">    P3 dir=cross(k2-k1,k4-k3); <span class="keyword">if</span> (sign(dir.<span class="built_in">abs</span>())==<span class="number">0</span>) <span class="keyword">return</span> disLP(k1,k2,k3);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(dot(dir.unit(),k1-k2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VP <span class="title">getFL</span><span class="params">(P3 p,P3 dir,P3 k1,P3 k2)</span></span>&#123;</span><br><span class="line">    db a=dot(k2-p,dir),b=dot(k1-p,dir),d=a-b;</span><br><span class="line">    <span class="keyword">if</span> (sign(<span class="built_in">fabs</span>(d))==<span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> &#123;(k1*a-k2*b)/d&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VP <span class="title">getFF</span><span class="params">(P3 p1,P3 dir1,P3 p2,P3 dir2)</span></span>&#123;<span class="comment">// 返回一条线</span></span><br><span class="line">    P3 e=cross(dir1,dir2),v=cross(dir1,e);</span><br><span class="line">    db d=dot(dir2,v); <span class="keyword">if</span> (sign(<span class="built_in">abs</span>(d))==<span class="number">0</span>) <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    P3 q=p1+v*dot(dir2,p2-p1)/d; <span class="keyword">return</span> &#123;q,q+e&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3D Covex Hull Template</span></span><br><span class="line"><span class="function">db <span class="title">getV</span><span class="params">(P3 k1,P3 k2,P3 k3,P3 k4)</span></span>&#123; <span class="comment">// get the Volume</span></span><br><span class="line">    <span class="keyword">return</span> dot(cross(k2-k1,k3-k1),k4-k1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">rand_db</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> <span class="number">1.0</span>*rand()/RAND_MAX;&#125;</span><br><span class="line"><span class="function">VP <span class="title">convexHull2D</span><span class="params">(VP A,P3 dir)</span></span>&#123;</span><br><span class="line">    P3 x=&#123;(db)rand(),(db)rand(),(db)rand()&#125;; x=x.unit();</span><br><span class="line">    x=cross(x,dir).unit(); P3 y=cross(x,dir).unit();</span><br><span class="line">    P3 vec=dir.unit()*dot(A[<span class="number">0</span>],dir);</span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt;B;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;A.size();i++) B.push_back((point)&#123;dot(A[i],x),dot(A[i],y)&#125;);</span><br><span class="line">    B=ConvexHull(B); A.clear();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;B.size();i++) A.push_back(x*B[i].x+y*B[i].y+vec);</span><br><span class="line">    <span class="keyword">return</span> A;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> CH3&#123;</span><br><span class="line">    VVP ret; <span class="built_in">set</span>&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt;e;</span><br><span class="line">    <span class="keyword">int</span> n; VP p,q;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">wrap</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e.find(&#123;a,b&#125;)==e.end())&#123;</span><br><span class="line">            <span class="keyword">int</span> c=<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) <span class="keyword">if</span> (i!=a&amp;&amp;i!=b)&#123;</span><br><span class="line">                <span class="keyword">if</span> (c==<span class="number">-1</span>||sign(getV(q[c],q[a],q[b],q[i]))&gt;<span class="number">0</span>) c=i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (c!=<span class="number">-1</span>)&#123;</span><br><span class="line">                ret.push_back(&#123;p[a],p[b],p[c]&#125;);</span><br><span class="line">                e.insert(&#123;a,b&#125;); e.insert(&#123;b,c&#125;); e.insert(&#123;c,a&#125;);</span><br><span class="line">                wrap(c,b); wrap(a,c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">VVP <span class="title">ConvexHull3D</span><span class="params">(VP _p)</span></span>&#123;</span><br><span class="line">        p=q=_p; n=p.size();</span><br><span class="line">        ret.clear(); e.clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i:q) i=i+(P3)&#123;rand_db()*<span class="number">1e-4</span>,rand_db()*<span class="number">1e-4</span>,rand_db()*<span class="number">1e-4</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++) <span class="keyword">if</span> (q[i].x&lt;q[<span class="number">0</span>].x) swap(p[<span class="number">0</span>],p[i]),swap(q[<span class="number">0</span>],q[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;n;i++) <span class="keyword">if</span> ((q[i].x-q[<span class="number">0</span>].x)*(q[<span class="number">1</span>].y-q[<span class="number">0</span>].y)&gt;(q[i].y-q[<span class="number">0</span>].y)*(q[<span class="number">1</span>].x-q[<span class="number">0</span>].x)) swap(q[<span class="number">1</span>],q[i]),swap(p[<span class="number">1</span>],p[i]);</span><br><span class="line">        wrap(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VVP <span class="title">reduceCH</span><span class="params">(VVP A)</span></span>&#123;</span><br><span class="line">    VVP ret; <span class="built_in">map</span>&lt;P3,VP&gt; M;</span><br><span class="line">    <span class="keyword">for</span> (VP nowF:A)&#123;</span><br><span class="line">        P3 dir=cross(nowF[<span class="number">1</span>]-nowF[<span class="number">0</span>],nowF[<span class="number">2</span>]-nowF[<span class="number">0</span>]).unit();</span><br><span class="line">        <span class="keyword">for</span> (P3 k1:nowF) M[dir].pb(k1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (pair&lt;P3,VP&gt; nowF:M) ret.pb(convexHull2D(nowF.se,nowF.fi));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  把一个面变成 ( 点 , 法向量 ) 的形式</span></span><br><span class="line">pair&lt;P3,P3&gt; getF(VP F)&#123;</span><br><span class="line">    <span class="keyword">return</span> mp(F[<span class="number">0</span>],cross(F[<span class="number">1</span>]-F[<span class="number">0</span>],F[<span class="number">2</span>]-F[<span class="number">0</span>]).unit());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3D Cut 保留 dot(dir,x-p)&gt;=0 的部分</span></span><br><span class="line"><span class="function">VVP <span class="title">ConvexCut3D</span><span class="params">(VVP A,P3 p,P3 dir)</span></span>&#123;</span><br><span class="line">    VVP ret; VP sec;</span><br><span class="line">    <span class="keyword">for</span> (VP nowF: A)&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nowF.size(); VP ans; <span class="keyword">int</span> dif=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> d1=sign(dot(dir,nowF[i]-p));</span><br><span class="line">            <span class="keyword">int</span> d2=sign(dot(dir,nowF[(i+<span class="number">1</span>)%n]-p));</span><br><span class="line">            <span class="keyword">if</span> (d1&gt;=<span class="number">0</span>) ans.pb(nowF[i]);</span><br><span class="line">            <span class="keyword">if</span> (d1*d2&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                P3 q=getFL(p,dir,nowF[i],nowF[(i+<span class="number">1</span>)%n])[<span class="number">0</span>];</span><br><span class="line">                ans.push_back(q); sec.push_back(q);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (d1==<span class="number">0</span>) sec.push_back(nowF[i]); <span class="keyword">else</span> dif=<span class="number">1</span>;</span><br><span class="line">            dif|=(sign(dot(dir,cross(nowF[(i+<span class="number">1</span>)%n]-nowF[i],nowF[(i+<span class="number">1</span>)%n]-nowF[i])))==<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ans.size()&gt;<span class="number">0</span>&amp;&amp;dif) ret.push_back(ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sec.size()&gt;<span class="number">0</span>) ret.push_back(convexHull2D(sec,dir));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">db <span class="title">vol</span><span class="params">(VVP A)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (A.size()==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; P3 p=A[<span class="number">0</span>][<span class="number">0</span>]; db ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (VP nowF:A)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;nowF.size();i++)</span><br><span class="line">            ans+=<span class="built_in">abs</span>(getV(p,nowF[<span class="number">0</span>],nowF[i<span class="number">-1</span>],nowF[i]));</span><br><span class="line">    <span class="keyword">return</span> ans/<span class="number">6</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">VVP <span class="title">init</span><span class="params">(db INF)</span> </span>&#123;</span><br><span class="line">    VVP pss(6,VP(4));</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">0</span>] = pss[<span class="number">1</span>][<span class="number">0</span>] = pss[<span class="number">2</span>][<span class="number">0</span>] = &#123;-INF, -INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">3</span>] = pss[<span class="number">1</span>][<span class="number">1</span>] = pss[<span class="number">5</span>][<span class="number">2</span>] = &#123;-INF, -INF, INF&#125;;</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">1</span>] = pss[<span class="number">2</span>][<span class="number">3</span>] = pss[<span class="number">4</span>][<span class="number">2</span>] = &#123;-INF, INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">0</span>][<span class="number">2</span>] = pss[<span class="number">5</span>][<span class="number">3</span>] = pss[<span class="number">4</span>][<span class="number">1</span>] = &#123;-INF, INF, INF&#125;;</span><br><span class="line">    pss[<span class="number">1</span>][<span class="number">3</span>] = pss[<span class="number">2</span>][<span class="number">1</span>] = pss[<span class="number">3</span>][<span class="number">2</span>] = &#123;INF, -INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">1</span>][<span class="number">2</span>] = pss[<span class="number">5</span>][<span class="number">1</span>] = pss[<span class="number">3</span>][<span class="number">3</span>] = &#123;INF, -INF, INF&#125;;</span><br><span class="line">    pss[<span class="number">2</span>][<span class="number">2</span>] = pss[<span class="number">4</span>][<span class="number">3</span>] = pss[<span class="number">3</span>][<span class="number">1</span>] = &#123;INF, INF, -INF&#125;;</span><br><span class="line">    pss[<span class="number">5</span>][<span class="number">0</span>] = pss[<span class="number">4</span>][<span class="number">0</span>] = pss[<span class="number">3</span>][<span class="number">0</span>] = &#123;INF, INF, INF&#125;;</span><br><span class="line">    <span class="keyword">return</span> pss;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/28/线段树模板/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/28/线段树模板/" itemprop="url">线段树模板</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-28T21:13:24+08:00">
                2018-12-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><p>线段树还不是很熟练，拿个Amori的线段树板子</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a><strong>思路：</strong></h2><h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">ll ans[maxn*<span class="number">4</span>];</span><br><span class="line"><span class="keyword">int</span> a[maxn];</span><br><span class="line">ll tag[maxn*<span class="number">4</span>];</span><br><span class="line"><span class="function">ll <span class="title">sum</span><span class="params">(ll a,ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[o]=a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> lson=o&lt;&lt;<span class="number">1</span>,rson=lson|<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson,l,m);</span><br><span class="line">    build(rson,m+<span class="number">1</span>,r);</span><br><span class="line">    ans[o]=sum(ans[lson], ans[rson]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> ql,<span class="keyword">int</span> qr,<span class="keyword">int</span> k)</span><span class="comment">//区间修改:将[l,r]区间每个数都加上k</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lson=o&lt;&lt;<span class="number">1</span>,rson=lson|<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql&lt;=l&amp;&amp;qr&gt;=r)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[o]+=k*(r-l+<span class="number">1</span>)</span><br><span class="line">        tag[o]+=k;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tag[o])</span><br><span class="line">    &#123;</span><br><span class="line">        tag[lson]+=tag[o];</span><br><span class="line">        tag[rson]+=tag[o];</span><br><span class="line">        ans[lson]+=tag[o]*(m-l+<span class="number">1</span>)</span><br><span class="line">        ans[rson]+=tag[o]*(r-m);</span><br><span class="line">        tag[o]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(qr&lt;=m)</span><br><span class="line">        update(lson,l,m,ql,qr,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ql&gt;m)</span><br><span class="line">        update(rson,m+<span class="number">1</span>,r,ql,qr,k);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        update(lson,l,m,ql,qr,k);</span><br><span class="line">        update(rson,m+<span class="number">1</span>,r,ql,qr,k);</span><br><span class="line">    &#125;</span><br><span class="line">    ans[o]=ans[lson]+ans[rson];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update_p</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span><span class="comment">//单点修改:将a[x]加上y</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     <span class="keyword">if</span>(L==R)</span><br><span class="line">	&#123;</span><br><span class="line">          ans[o]+=y</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">int</span> m=(l+r)/<span class="number">2</span>,lson=o&lt;&lt;<span class="number">1</span>,rson=lson|<span class="number">1</span>;</span><br><span class="line">     <span class="keyword">if</span>(x&lt;=m)update(lson,l,m,x,y);</span><br><span class="line">     <span class="keyword">else</span> update(rson,m+<span class="number">1</span>,r,x,y);</span><br><span class="line">	ans[o]=ans[lson]+ans[rson];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> o,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> ql,<span class="keyword">int</span> qr)</span><span class="comment">//区间查询</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lson=o&lt;&lt;<span class="number">1</span>,rson=lson|<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql&lt;=l&amp;&amp;qr&gt;=r)</span><br><span class="line">        <span class="keyword">return</span> ans[o];</span><br><span class="line">    <span class="keyword">if</span>(tag[o])</span><br><span class="line">    &#123;</span><br><span class="line">        tag[lson]+=tag[o];</span><br><span class="line">        tag[rson]+=tag[o];</span><br><span class="line">        ans[lson]+=tag[o]*(m-l+<span class="number">1</span>)</span><br><span class="line">        ans[rson]+=tag[o]*(r-m);</span><br><span class="line">        tag[o]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(qr&lt;=m)</span><br><span class="line">        <span class="keyword">return</span> query(lson,l,m,ql,qr);</span><br><span class="line">    <span class="keyword">if</span>(ql&gt;m)</span><br><span class="line">        <span class="keyword">return</span> query(rson,m+<span class="number">1</span>,r,ql,qr);</span><br><span class="line">    <span class="keyword">return</span> query(lson,l,m,ql,qr)+query(rson,m+<span class="number">1</span>,r,ql,qr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/11/Codeforces1091Div2D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/11/Codeforces1091Div2D/" itemprop="url">Codeforces1091Div2D-The Fair Nut and the Best Path</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-11T04:11:10+08:00">
                2018-12-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><p>outputstandard output<br>The Fair Nut is going to travel to the Tree Country, in which there are n cities. Most of the land of this country is covered by forest. Furthermore, the local road system forms a tree (connected graph without cycles). Nut wants to rent a car in the city u and go by a simple path to city v. He hasn’t determined his way, so it’s time to do it.</p>
<p>A filling station is located in every city. Because of strange law, Nut can buy only wi liters of gasoline in the i-th city. We can assume, that he has infinite money. Each road has a length, and as soon as Nut drives through this road, the amount of gasoline decreases by length. Of course, Nut can’t choose a path, which consists of roads, where he runs out of gasoline. He can buy gasoline in every visited city, even in the first and the last.</p>
<p>A path can consist of only one vertex.</p>
<p>He also wants to find the maximum amount of gasoline that he can have at the end of the path. Help him: count it.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><p>The first line contains a single integer n (1≤n≤3⋅105) — the number of cities.<br>The second line contains n integers w1,w2,…,wn (0≤wi≤109) — the maximum amounts of liters of gasoline that Nut can buy in cities.<br>Each of the next n−1 lines describes road and contains three integers u, v, c (1≤u,v≤n, 1≤c≤109, u≠v), where u and v — cities that are connected by this road and c — its length.<br>It is guaranteed that graph of road connectivity is a tree.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><p>Print one number — the maximum amount of gasoline that he can have at the end of the path.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><p>3<br>1 3 3<br>1 2 2<br>1 3 2</p>
<p>5<br>6 3 2 5 0<br>1 2 10<br>2 3 3<br>2 4 1<br>1 5 1</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><p>3</p>
<p>7</p>
<h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>给一棵n个节点的树， 每个节点上都有一个权值$w_i$，每条边上有一个花费$c_i$，任意选择起点u和终点v(u和v可以是同一个节点)，定义价值$x(u, v)$为从起点u到终点v的路径上所有的节点的权值之和减去所有的边的花费最大，输出这个最大值，其中，到达任任何一个节点的前一瞬间，x不能是负数。输出最大的x。</p>
<h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a><strong>思路：</strong></h2><p>树上dp。以节点1为起点dfs，$dp[u]=w[u]+max(0, max(dp[v]-c[u, v]))$,其中dp[i]表示，额，好像没有特别明确的含义，大概是表示经过i节点的最大收益吧，显然不一定非要从叶子节点一直push到根节点，也可以中间节点的某两条子树路径是答案，因此需要拿到(dp[v]-c[u, v])中的最大的两个值，这里可以O(n)做，但是由于排序O(nlogn)是没有卡的，所以直接排序也是可以的，但是我在比赛中用了很蠢的O(n^2)，不知道自己是怎么想的，然后愉快的fst了，掉分哭唧唧。然后就xjb更新答案就行了。</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">1000000007</span>;</span><br><span class="line"><span class="keyword">const</span> ll maxn = <span class="number">5e5</span>+<span class="number">7</span>;</span><br><span class="line">ll a[maxn];</span><br><span class="line"><span class="built_in">vector</span>&lt;pair&lt;ll, ll&gt; &gt; G[maxn];</span><br><span class="line"><span class="keyword">int</span> vis[maxn];</span><br><span class="line">ll ans = <span class="number">-1</span>;</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> f, <span class="keyword">int</span> u, ll c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = a[u];</span><br><span class="line">    <span class="built_in">vector</span>&lt;ll&gt; tmp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G[u].size();++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(G[u][i].first==f)<span class="keyword">continue</span>;</span><br><span class="line">        ll t = dfs(u, G[u][i].first, G[u][i].second);</span><br><span class="line">        res = max(res, t+a[u]);</span><br><span class="line">        tmp.push_back(t);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(tmp.begin(), tmp.end(), greater&lt;ll&gt;());</span><br><span class="line">    tmp.push_back(<span class="number">0</span>);</span><br><span class="line">    tmp.push_back(<span class="number">0</span>);</span><br><span class="line">    ans = max(a[u]+tmp[<span class="number">0</span>]+tmp[<span class="number">1</span>], ans);</span><br><span class="line">    ans = max(ans, res);</span><br><span class="line">    <span class="keyword">return</span> res-c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ll u, v, c;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; c;</span><br><span class="line">        G[u].push_back(make_pair(v, c));</span><br><span class="line">        G[v].push_back(make_pair(u, c));</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/11/Codeforces526Div2E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/11/Codeforces526Div2E/" itemprop="url">Codeforces1091Div2E-The Fair Nut and Strings</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-11T03:37:32+08:00">
                2018-12-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><p>Recently, the Fair Nut has written k strings of length n, consisting of letters “a” and “b”. He calculated c — the number of strings that are prefixes of at least one of the written strings. Every string was counted only one time.</p>
<p>Then, he lost his sheet with strings. He remembers that all written strings were lexicographically not smaller than string s and not bigger than string t. He is interested: what is the maximum value of c that he could get.</p>
<p>A string a is lexicographically smaller than a string b if and only if one of the following holds:</p>
<ul>
<li>a is a prefix of b, but a≠b;</li>
<li>in the first position where a and b differ, the string a has a letter that appears earlier in the alphabet than the corresponding letter in b.<br><strong>Input</strong></li>
</ul>
<hr>
<p>The first line contains two integers n and k (1≤n≤5⋅105, 1≤k≤$10^9$).<br>The second line contains a string s (|s|=n) — the string consisting of letters “a” and “b.<br>The third line contains a string t (|t|=n) — the string consisting of letters “a” and “b.<br>It is guaranteed that string s is lexicographically not bigger than t.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><p>Print one number — maximal value of c.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><p>2 4<br>aa<br>bb</p>
<p>3 3<br>aba<br>bba</p>
<p>4 5<br>abbb<br>baaa</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><p>6</p>
<p>8</p>
<p>8</p>
<h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>给两个只由字符ab构成的长度为n的字符串s、t，保证s的字典序一定小于t，求字典序小于t且大于s的所有长度为n的字符串中选出k个，使得从中得到的本质不同的前缀的数量最大，输出这个最大值。</p>
<h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a><strong>思路：</strong></h2><p>比赛的时候想了一下没有k这个限制的做法，然后没有往深的地方想，结束之后发现原来做法是差不太多的。<br>考虑一个完全二叉字典树，其中每个节点最多只有两个儿子，也就是‘a’和’b’，将s和t插进去，显然答案就是从这个字典树中s的叶子结点和t的叶子节点之间选出k个叶子节点，使得这k条路经上的总结点数最大。<br>但是由于我们只需要统计数量，因此不需要真的把这棵树建起来，我们通过观察这颗字典树可以发现，假设s[i-1]和t[i-1]在树上的距离为d（也就是他们之间的同级节点的个数加1），则分类讨论，当s[i]=t[i]时，他们相对于s[i-1]和t[i-1]的方向都相同，因此的距离为2<em>d-1，如果s[i]&gt;t[i]，那么距离为2</em>d,否则距离为2*d-2。<br>口胡式证明正确性：当两个节点之间的距离小于k的时候，显然每条路径都经过是最优的，当两个节点之间的距离大于k的时候，直接加上k就可以了。首先这样的做法肯定是达到了上界，没有其他做法能比这样的策略获得的贡献更大，其次，如果这层节点的上一层节点距离已经可以走k条路经，显然这一层也可以走k条路经，如果上一层的距离小于k，那么这一层的每个节点肯定都是可达的，可行性得证。所以这个做法是没毛病的。实现起来比较简单。</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n, k;</span><br><span class="line">    <span class="built_in">string</span> s, t;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s &gt;&gt; t;</span><br><span class="line">    ll ans = <span class="number">0</span>, tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</span><br><span class="line">        <span class="keyword">if</span>(tmp&lt;k)</span><br><span class="line">        &#123;</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==t[i]) --tmp;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(s[i]==<span class="string">'b'</span>&amp;&amp;t[i]==<span class="string">'a'</span>)tmp-=<span class="number">2</span>;</span><br><span class="line">            tmp = min(tmp, k);</span><br><span class="line">        &#125;</span><br><span class="line">        ans += tmp;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt;ans &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/24/Project-Euler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/24/Project-Euler/" itemprop="url">Project Euler</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-24T02:20:17+08:00">
                2018-11-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// P21</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">10000</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">2</span>;j*j&lt;=i;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%j==<span class="number">0</span>)</span><br><span class="line">                tmp += j + i/j;</span><br><span class="line">            <span class="keyword">if</span>(j*j==i) tmp -= j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> t = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">2</span>;j*j&lt;=tmp;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tmp%j==<span class="number">0</span>)</span><br><span class="line">                t += j + tmp/j;</span><br><span class="line">            <span class="keyword">if</span>(j*j==tmp) t -= j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(t==i&amp;&amp;i!=tmp)res.insert(t), res.insert(i);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x:res)ans += x;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># P22</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"in.txt"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    s = f.read().split(<span class="string">','</span>)</span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    s.sort()</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> s:</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> item:</span><br><span class="line">            <span class="keyword">if</span> p != <span class="string">'"'</span>:</span><br><span class="line">                tmp += ( ord(p)-ord(<span class="string">'A'</span>)+<span class="number">1</span> )</span><br><span class="line">        res += tmp * cnt</span><br><span class="line">        <span class="keyword">if</span> item == <span class="string">'"COLIN"'</span>:print(tmp,cnt,item)</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//P23</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">30000</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">28123</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">2</span>;j*j&lt;=i;++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i%j==<span class="number">0</span>) tmp += i/j+j;</span><br><span class="line">            <span class="keyword">if</span>(j*j==i) tmp -= j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(tmp&gt;i) res.push_back(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;res.size();++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;res.size();++j)</span><br><span class="line">            <span class="keyword">if</span>(res[i]+res[j]&gt;<span class="number">28123</span>) <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">else</span> vis[res[i]+res[j]]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">28123</span>;++i)</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">            ans += i;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">P24康拓展开裸题</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">30000</span>];</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> FAC[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">24</span>, <span class="number">120</span>, <span class="number">720</span>, <span class="number">5040</span>, <span class="number">40320</span>, <span class="number">362880</span>&#125;;   <span class="comment">// 阶乘</span></span><br><span class="line"><span class="comment">//康托展开逆运算</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decantor</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v;  <span class="comment">// 存放当前可选数</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a;  <span class="comment">// 所求排列组合</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n;i++)</span><br><span class="line">        v.push_back(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">10</span>;i&gt;=<span class="number">1</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> r = x % FAC[i<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">int</span> t = x / FAC[i<span class="number">-1</span>];</span><br><span class="line">        x = r;</span><br><span class="line">        sort(v.begin(),v.end());<span class="comment">// 从小到大排序</span></span><br><span class="line">        a.push_back(v[t]);      <span class="comment">// 剩余数里第t+1个数为当前位</span></span><br><span class="line">        v.erase(v.begin()+t);   <span class="comment">// 移除选做当前位的数</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> x: a) <span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">' '</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    decantor(<span class="number">999999</span>, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#P25</span></span><br><span class="line">L = []</span><br><span class="line">L.append(<span class="number">1</span>)</span><br><span class="line">L.append(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span>(L[<span class="number">-1</span>]&lt;pow(<span class="number">10</span>,<span class="number">999</span>)):</span><br><span class="line">    L.append(L[<span class="number">-1</span>]+L[<span class="number">-2</span>])</span><br><span class="line">print(len(L))</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/24/poj1837/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/24/poj1837/" itemprop="url">poj1837</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-24T00:24:31+08:00">
                2018-11-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><p>Gigel has a strange “balance” and he wants to poise it. Actually, the device is different from any other ordinary balance.<br>It orders two arms of negligible weight and each arm’s length is 15. Some hooks are attached to these arms and Gigel wants to hang up some weights from his collection of G weights (1 &lt;= G &lt;= 20) knowing that these weights have distinct values in the range 1..25. Gigel may droop any weight of any hook but he is forced to use all the weights.<br>Finally, Gigel managed to balance the device using the experience he gained at the National Olympiad in Informatics. Now he would like to know in how many ways the device can be balanced. </p>
<p>Knowing the repartition of the hooks and the set of the weights write a program that calculates the number of possibilities to balance the device.<br>It is guaranteed that will exist at least one solution for each test case at the evaluation. </p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><p>The input has the following structure:<br>• the first line contains the number C (2 &lt;= C &lt;= 20) and the number G (2 &lt;= G &lt;= 20);<br>• the next line contains C integer numbers (these numbers are also distinct and sorted in ascending order) in the range -15..15 representing the repartition of the hooks; each number represents the position relative to the center of the balance on the X axis (when no weights are attached the device is balanced and lined up to the X axis; the absolute value of the distances represents the distance between the hook and the balance center and the sign of the numbers determines the arm of the balance to which the hook is attached: ‘-‘ for the left arm and ‘+’ for the right arm);<br>• on the next line there are G natural, distinct and sorted in ascending order numbers in the range 1..25 representing the weights’ values. </p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><p>The output contains the number M representing the number of possibilities to poise the balance.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><p>2 4<br>-2 3<br>3 4 5 8</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><p>2</p>
<h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>天平上有n个不同位置的挂钩，有m种不同质量的钩码，求有多少种让天平平衡的方法。钩码需要全部用上。</p>
<h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a><strong>思路：</strong></h2><p>设$dp[i][j]$表示前i个钩码，使目前天平的力矩为j的方案有多少种，其中j==0时表示天平平衡。则对于当前第i个钩码如果状态j可以由j-w[i]<em>c[k]得到，那么加上它的方案数.即$$dp[i][j]=\Sigma_{k=0}^ndp[i][j-w[i]</em>p[k]]$$当然此时j作为下标不能是负数，因此往正方向移动（20<em>15</em>25=7500位）。注意处理一下$j-w[i]<em>p[k]$超过范围时不考虑。当然也可以换成扫$j-w[i]</em>p[k]$，这样还可以剪枝。</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">2</span>][<span class="number">15002</span>], p[<span class="number">50</span>], w[<span class="number">70</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, t = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) <span class="built_in">cin</span> &gt;&gt; p[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i) <span class="built_in">cin</span> &gt;&gt; w[i];</span><br><span class="line">    dp[t][<span class="number">7500</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        t^=<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">memset</span>(dp[t], <span class="number">0</span>, <span class="keyword">sizeof</span> dp[t]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=<span class="number">15000</span>;++j)</span><br><span class="line">            <span class="keyword">if</span>(dp[<span class="number">1</span>^t][j])</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;n;++k)</span><br><span class="line">                    dp[t][j+w[i]*p[k]] += dp[t^<span class="number">1</span>][j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; dp[t][<span class="number">7500</span>] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/12/2018青岛区域赛总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/12/2018青岛区域赛总结/" itemprop="url">2018青岛区域赛总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-12T22:24:16+08:00">
                2018-11-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="成绩"><a href="#成绩" class="headerlink" title="成绩"></a>成绩</h2><p>题数：5题<br>罚时：626<br>排名：Rank56<br>奖牌：银牌</p>
<h2 id="比赛过程："><a href="#比赛过程：" class="headerlink" title="比赛过程："></a>比赛过程：</h2><h3 id="热身赛"><a href="#热身赛" class="headerlink" title="热身赛"></a>热身赛</h3><p>算是第一次参加热身赛【省赛那个也不算吧，当时还一脸懵逼不知道要干嘛<br>刚开始我在搞机器，amori很快看完了所有题目，然后告诉了我做法让我写，然而我不知道是紧张还是什么原因，码的磕磕绊绊的，还直接wa了一发，然后换amori上来写A和B，我看了一下C，感觉是放上来做压力测试的，就不打算交了，打算测其他的东西的时候PC^2挂掉了，于是又等了许久恢复后才继续测其他的，发现了行末空格会返回OFE，评测实在是太慢了，就没测能跑多大的时间复杂度了，<del> 反正也是要莽。 </del></p>
<h3 id="热身赛当晚"><a href="#热身赛当晚" class="headerlink" title="热身赛当晚"></a>热身赛当晚</h3><p>由于下午的时候我的状态实在是太差，于是当晚拉了几道简单题做，事实证明这是我们当时做的最正确的决定之一了，因为不仅调整了状态，而且还使我(们)更加了解队友的思维习惯和学习经历，<del>而且还刚好做了一道二分最大化最小值的问题。</del></p>
<h3 id="正式赛当天"><a href="#正式赛当天" class="headerlink" title="正式赛当天"></a>正式赛当天</h3><p>比赛开始，还是按照原本的开题顺序，amori从头，cmr从D开始，而我先去搞了一下机器和调了下gedit，调好之后看了一眼M，感觉是个签到题，往下一扫，签到成功这是你的签到奖励.jpg，果断直接开始写，交上去1A，然后扫了一眼榜，C和J有人过，然后amori给我讲了J的题意，讨论了一下就开始写了，WA，换amori写，39minA。这时我发现有支中学生队过了G，于是觉得这应该是一个算法题而非思维题，从过的那么快来看amori可能是可做的，于是我就<del>忽悠</del>amori去看G，<del>然后这家伙就看漏题意了</del>。Amori过J之后我和cmr就开始一边讨论C一边写，63min的时候1A。这个时候刷了一下榜，发现冲上了金线【然而并没有什么卵用】，开始了长达一个小时的挂机时间，期间amori和cmr给我讲了BDEFGLK的题意，<del>然而其中有4个题目都是没讲清楚的</del>，L感觉是要推出组合公式，因为看起来就没有啥递推式，<del>然后就自闭了</del>，然后果断把这道题丢给cmr，去仔细的看了一下F题，发现是个构造题，应该是当时最可做的，于是和cmr一边讨论一边写一边调，然后发现是写挫了，换了个写法交上去161min1A，此时大概在银牌头的位置。amori确定了E二分加贪心的做法，避开了爆longlong的坑，但是忘了特判，于是又开始了长达一个小时的xjb搞+莽的自闭时间，所幸250min的时候利用随机数据找到了问题，过了。然后就开始了本次比赛最傻逼的时间。看了看榜，在没有歪榜的情况下，D和L应该是最可做的，但是当时的心态，实在是太跳了，虽然D和L看起来可做但是没有很用心思考。列了列L小数据的答案，决定果断放弃【。然后和cmr一起口头D题，说出了正解，但是很快被我随口说了一个ac自动机给糊弄了，然后还忽悠amori去写了，然后就发现做法不对，浪费了宝贵的半个小时，于是剩下的时间就在吃东西和吹水了。最终是毫无悬念的5题银牌，罚时还算是比较能看的，除了E题，相比我们平时训练来说。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>首先结论，这次的银牌，关键原因是因为运气好，因为我们队三个人都相信换成大二的其他队伍来QD赛区成绩都应该和我们差不多。<br>其次，这次做得比较好的是，热身赛的时候发现状态不对，当晚便选择做了几道简单题来调整状态。<br>再其次，更加信任队友了，<del>虽然信任了但还是没做出来L</del>，但势必会使得后面的训练更加融洽。<br>再再其次，这次前期没有特别明显的卡题，中期没有死咬着一道题不放。<br>然后，这次暴露出来的比较明显的缺点（主要是指我）是，对于不确定方法对不对的题目，即使是在中后期，我都很难下决心去试试，这个在平时训练的时候已经显示出来了，但是一直没有重视。因为cmr不是代码手，而这种题目一般不经过amori的手，所以我不写的话不行。<br>再然后，还是出现了读错题/读漏题的情况，原本在没有思路的时候我应该把每个题目再好好读一遍的，结果还是没有，这种情况不改的话，随着每个队员能力的提升，对队伍的影响会越来越大。<br>再再然后就是最本质的解题能力太差的问题，包括常规套路和思维题的训练都太少。</p>
<h3 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h3><p>从下周起直到十二月初的选拔赛结束为止【可能会更久，也可能根据实际情况修改】，我们队都以个人的单挑实力提升为主，在没有其他变数的情况下，每周只会有一场左右的队伍训练。<br>1，在训练时应同时注意常规算法套路和思维题【抖机灵题】的训练。<br>2，注意涉及的广度，尽量做到每个知识点即使没法很快做出来，在和队友讨论或者经提醒之后能知道怎么做，至少在比赛中能和队友讨论相关做法。<br>3，注意深度，对于自己擅长的领域，要做到不依赖任何人和搜索引擎的情况下能独立解出有一定综合难度的问题。<br>4，对今年的杭电多校牛客多校要注意补题。<br>5，关注codeforces的比赛<br>6，注意代码实现能力的培养@cmr。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/09/POJ1840Eqs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/09/POJ1840Eqs/" itemprop="url">POJ1840Eqs</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-09T00:05:58+08:00">
                2018-11-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><p>Consider equations having the following form:<br>a1x1 3+ a2x2 3+ a3x3 3+ a4x4 3+ a5x5 3=0<br>The coefficients are given integers from the interval [-50,50].<br>It is consider a solution a system (x1, x2, x3, x4, x5) that verifies the equation, xi∈[-50,50], xi != 0, any i∈{1,2,3,4,5}. </p>
<p>Determine how many solutions satisfy the given equation. </p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><p>The only line of input contains the 5 coefficients a1, a2, a3, a4, a5, separated by blanks.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><p>The output will contain on the first line the number of the solutions for the given equation.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><p>37 29 41 43 47</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><p>654</p>
<h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>求满足那个方程的解的个数。</p>
<h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a><strong>思路：</strong></h2><p>数据范围较小，考虑暴力枚举，对$a_1x_1^3+a_2x_2^3+a_3x_3^3+a_4x_4^3+a_5x_5^3=0$变形得$-(a_1x_1^3+a_2x_2^3)=a_3x_3^3+a_4x_4^3+a_5x_5^3$，枚举左边，存一个hash表，hash[i]表示左边和为i的方案数，再枚举右边即可获取答案。复杂度$O(100^3)$，另外由于可能出现负数，所以要做一下偏移。思路和折半枚举类似，但是那个可以做浮点数的。</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> s = <span class="number">25000000</span>;</span><br><span class="line"><span class="keyword">short</span> res[s+<span class="number">10</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">5</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;++i) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">-50</span>;i&lt;=<span class="number">50</span>;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">-50</span>;j&lt;=<span class="number">50</span>;++j)</span><br><span class="line">        <span class="keyword">if</span>(i!=<span class="number">0</span>&amp;&amp;j!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> t = i*i*i*a[<span class="number">0</span>]+j*j*j*a[<span class="number">1</span>];t*=<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(t&lt;<span class="number">0</span>) t += s;</span><br><span class="line">            res[t]++;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">-50</span>;i&lt;=<span class="number">50</span>;++i)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">-50</span>;j&lt;=<span class="number">50</span>;++j)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">-50</span>;k&lt;=<span class="number">50</span>;++k)</span><br><span class="line">                <span class="keyword">if</span>(i!=<span class="number">0</span>&amp;&amp;j!=<span class="number">0</span>&amp;&amp;k!=<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> t = i*i*i*a[<span class="number">2</span>]+j*j*j*a[<span class="number">3</span>]+k*k*k*a[<span class="number">4</span>];</span><br><span class="line">        <span class="keyword">if</span>(t&lt;<span class="number">0</span>) t += s;</span><br><span class="line">            ans += res[t];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/08/BZOJ1002轮状病毒/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嗷嗷嗷">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="嗷嗷嗷's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/08/BZOJ1002轮状病毒/" itemprop="url">BZOJ1002轮状病毒</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-08T23:30:04+08:00">
                2018-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        
          
            <h2 id="题意描述"><a href="#题意描述" class="headerlink" title="题意描述"></a><strong>题意描述</strong></h2><p>轮状病毒有很多变种，所有轮状病毒的变种都是从一个轮状基产生的。一个N轮状基由圆环上N个不同的基原子<br>和圆心处一个核原子构成的，2个原子之间的边表示这2个原子之间的信息通道。N轮状病毒的产生规律是在一个N轮状基中删去若干条边，使得各原子之间有唯一的信息通道，例如共有16个不同的3轮状病毒。现给定n(N&lt;=100)，编程计算有多少个不同的n轮状病毒</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a><strong>Input</strong></h2><p>第一行有1个正整数n</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a><strong>Output</strong></h2><p>计算出的不同的n轮状病毒数输出</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a><strong>Sample Input</strong></h2><p>3</p>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a><strong>Sample Output</strong></h2><p>16</p>
<h2 id="题意："><a href="#题意：" class="headerlink" title="题意："></a><strong>题意：</strong></h2><p>给一个车轮状的无向图，生成树计数。</p>
<h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a><strong>思路：</strong></h2><p>利用基尔霍夫矩阵树定理，打表获得n为3到9时的答案，扔进BM板子里获得递推式，用java的BigInteger根据递推式写出答案。</p>
<h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a><strong>代码：</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner cin=<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">int</span> n=cin.nextInt();</span><br><span class="line">        BigInteger[] arr = <span class="keyword">new</span> BigInteger[<span class="number">101</span>];</span><br><span class="line">        arr[<span class="number">0</span>] = <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>);</span><br><span class="line">        arr[<span class="number">1</span>] = <span class="keyword">new</span> BigInteger(<span class="string">"1"</span>);</span><br><span class="line">        arr[<span class="number">2</span>] = <span class="keyword">new</span> BigInteger(<span class="string">"5"</span>);</span><br><span class="line">        arr[<span class="number">3</span>] = <span class="keyword">new</span> BigInteger(<span class="string">"16"</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">4</span>;i&lt;=n;++i)</span><br><span class="line">            arr[i] = arr[i-<span class="number">1</span>].subtract(arr[i-<span class="number">2</span>]).multiply(<span class="keyword">new</span> BigInteger(<span class="string">"4"</span>)).add(arr[i-<span class="number">3</span>]);</span><br><span class="line">        System.out.println(arr[n]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">嗷嗷嗷</p>
              <p class="site-description motion-element" itemprop="description">ACM, 数学, 编程, 怪物猎人(?)</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">嗷嗷嗷</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
